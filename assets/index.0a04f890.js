(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=e(o);fetch(o.href,r)}})();function St(){}function Me(t){return t()}function me(){return Object.create(null)}function $t(t){t.forEach(Me)}function Xe(t){return typeof t=="function"}function de(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Qe(t){return Object.keys(t).length===0}function h(t,e){t.appendChild(e)}function I(t,e,n){t.insertBefore(e,n||null)}function R(t){t.parentNode.removeChild(t)}function Lt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function w(t){return document.createElement(t)}function N(t){return document.createTextNode(t)}function z(){return N(" ")}function ue(){return N("")}function B(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function g(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Dt(t){return t===""?null:+t}function Ye(t){return Array.from(t.childNodes)}function ht(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function gt(t,e){t.value=e==null?"":e}function xt(t,e,n,o){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}let Yt;function Ze(){if(Yt===void 0){Yt=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Yt=!0}}return Yt}function tn(t,e){getComputedStyle(t).position==="static"&&(t.style.position="relative");const n=w("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const o=Ze();let r;return o?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",r=B(window,"message",a=>{a.source===n.contentWindow&&e()})):(n.src="about:blank",n.onload=()=>{r=B(n.contentWindow,"resize",e)}),h(t,n),()=>{(o||r&&n.contentWindow)&&r(),R(n)}}function M(t,e,n){t.classList[n?"add":"remove"](e)}let Wt;function qt(t){Wt=t}function en(){if(!Wt)throw new Error("Function called outside component initialization");return Wt}function nn(t){en().$$.after_update.push(t)}function Fe(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(o=>o.call(this,e))}const Ft=[],ft=[],ee=[],ae=[],qe=Promise.resolve();let se=!1;function We(){se||(se=!0,qe.then(He))}function Zt(){return We(),qe}function ie(t){ee.push(t)}function Pt(t){ae.push(t)}const oe=new Set;let te=0;function He(){const t=Wt;do{for(;te<Ft.length;){const e=Ft[te];te++,qt(e),rn(e.$$)}for(qt(null),Ft.length=0,te=0;ft.length;)ft.pop()();for(let e=0;e<ee.length;e+=1){const n=ee[e];oe.has(n)||(oe.add(n),n())}ee.length=0}while(Ft.length);for(;ae.length;)ae.pop()();se=!1,oe.clear(),qt(t)}function rn(t){if(t.fragment!==null){t.update(),$t(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ie)}}const ne=new Set;let Et;function It(){Et={r:0,c:[],p:Et}}function Gt(){Et.r||$t(Et.c),Et=Et.p}function G(t,e){t&&t.i&&(ne.delete(t),t.i(e))}function F(t,e,n,o){if(t&&t.o){if(ne.has(t))return;ne.add(t),Et.c.push(()=>{ne.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}else o&&o()}function Rt(t,e,n){const o=t.$$.props[e];o!==void 0&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function kt(t){t&&t.c()}function mt(t,e,n,o){const{fragment:r,on_mount:a,on_destroy:c,after_update:d}=t.$$;r&&r.m(e,n),o||ie(()=>{const i=a.map(Me).filter(Xe);c?c.push(...i):$t(i),t.$$.on_mount=[]}),d.forEach(ie)}function bt(t,e){const n=t.$$;n.fragment!==null&&($t(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function on(t,e){t.$$.dirty[0]===-1&&(Ft.push(t),We(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function he(t,e,n,o,r,a,c,d=[-1]){const i=Wt;qt(t);const l=t.$$={fragment:null,ctx:null,props:a,update:St,not_equal:r,bound:me(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(i?i.$$.context:[])),callbacks:me(),dirty:d,skip_bound:!1,root:e.target||i.$$.root};c&&c(l.root);let x=!1;if(l.ctx=n?n(t,e.props||{},(k,p,...m)=>{const u=m.length?m[0]:p;return l.ctx&&r(l.ctx[k],l.ctx[k]=u)&&(!l.skip_bound&&l.bound[k]&&l.bound[k](u),x&&on(t,k)),p}):[],l.update(),x=!0,$t(l.before_update),l.fragment=o?o(l.ctx):!1,e.target){if(e.hydrate){const k=Ye(e.target);l.fragment&&l.fragment.l(k),k.forEach(R)}else l.fragment&&l.fragment.c();e.intro&&G(t.$$.fragment),mt(t,e.target,e.anchor,e.customElement),He()}qt(i)}class ge{$destroy(){bt(this,1),this.$destroy=St}$on(e,n){const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(e){this.$$set&&!Qe(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ln(t){let e,n,o,r,a,c;return{c(){e=w("div"),n=N(t[1]),g(e,"style",o=t[0]&&t[2]?"background-color: "+t[2]+";":""),g(e,"class",r="h-10 p-2 "+(t[0]?t[3]:"")+" rounded-lg "+(t[0]?"border-solid":"border-none")+" border-2 text-center svelte-mesu7o")},m(d,i){I(d,e,i),h(e,n),a||(c=[B(e,"click",t[4]),B(e,"click",t[5])],a=!0)},p(d,[i]){i&2&&ht(n,d[1]),i&5&&o!==(o=d[0]&&d[2]?"background-color: "+d[2]+";":"")&&g(e,"style",o),i&9&&r!==(r="h-10 p-2 "+(d[0]?d[3]:"")+" rounded-lg "+(d[0]?"border-solid":"border-none")+" border-2 text-center svelte-mesu7o")&&g(e,"class",r)},i:St,o:St,d(d){d&&R(e),a=!1,$t(c)}}}function cn(t,e,n){let{checked:o=!1}=e,{text:r="O"}=e,{bgcolor:a=""}=e,{toggleClass:c=a?"":"bg-green-600"}=e,d=()=>{console.log("toggle"),n(0,o=!o)};function i(l){Fe.call(this,t,l)}return t.$$set=l=>{"checked"in l&&n(0,o=l.checked),"text"in l&&n(1,r=l.text),"bgcolor"in l&&n(2,a=l.bgcolor),"toggleClass"in l&&n(3,c=l.toggleClass)},[o,r,a,c,d,i]}class wt extends ge{constructor(e){super(),he(this,e,cn,ln,de,{checked:0,text:1,bgcolor:2,toggleClass:3})}}function be(t,e,n){const o=t.slice();return o[5]=e[n],o}function xe(t){let e,n;return{c(){e=w("span"),n=N("\xA0"),xt(e,"background-color",t[5])},m(o,r){I(o,e,r),h(e,n)},p:St,d(o){o&&R(e)}}}function an(t){let e,n,o,r,a,c,d=t[3],i=[];for(let l=0;l<d.length;l+=1)i[l]=xe(be(t,d,l));return{c(){e=w("button"),n=N(t[2]),o=z(),r=w("div");for(let l=0;l<i.length;l+=1)i[l].c();g(r,"class","svelte-63dooi"),g(e,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),M(e,"bg-green-600",t[1]==t[0])},m(l,x){I(l,e,x),h(e,n),h(e,o),h(e,r);for(let k=0;k<i.length;k+=1)i[k].m(r,null);a||(c=B(e,"click",t[4]),a=!0)},p(l,[x]){if(x&4&&ht(n,l[2]),x&8){d=l[3];let k;for(k=0;k<d.length;k+=1){const p=be(l,d,k);i[k]?i[k].p(p,x):(i[k]=xe(p),i[k].c(),i[k].m(r,null))}for(;k<i.length;k+=1)i[k].d(1);i.length=d.length}x&3&&M(e,"bg-green-600",l[1]==l[0])},i:St,o:St,d(l){l&&R(e),Lt(i,l),a=!1,c()}}}function sn(t,e,n){let{color:o=""}=e,{selected:r=""}=e,{name:a="default"}=e,c=o.split(",");function d(i){Fe.call(this,t,i)}return t.$$set=i=>{"color"in i&&n(0,o=i.color),"selected"in i&&n(1,r=i.selected),"name"in i&&n(2,a=i.name)},[o,r,a,c,d]}class dn extends ge{constructor(e){super(),he(this,e,sn,an,de,{color:0,selected:1,name:2})}}const je=(t,e)=>({r:t.r-e.r,g:t.g-e.g,b:t.b-e.b}),un=(t,e)=>({r:t.r+e.r,g:t.g+e.g,b:t.b+e.b}),hn=(t,e,n)=>Math.max(t,Math.min(e,n));let le={};const Ue=t=>{if(le[t])return le[t];{if(t.length==4){let[a,c,d,i]=t.split("");t="#"+c+c+d+d+i+i}let e=parseInt(t.substring(1,3),16),n=parseInt(t.substring(3,5),16),o=parseInt(t.substring(5,7),16),r={r:e,g:n,b:o};return le[t]=r,r}},pe=(t,e,n)=>{let o=je(n?Ke(t):t,e),r=Math.abs(o.r),a=Math.abs(o.g),c=Math.abs(o.b);return r*r+c*c+a*a};let ce={};const gn=(t,e,n)=>{let o;ce[e]?o=ce[e]:(o=e.split(","),ce[e]=o);let r=o[0],a=null;return o.forEach((c,d)=>{let i=Ue(c),l=pe(i,t,n);(a==null||a>l)&&(a=l,r=i)}),r},pn=(t,e,n)=>{let o=e[0],r=null;return e.forEach((a,c)=>{let d=pe(a,t,n);(r==null||r>d)&&(r=d,o=a)}),o},Je=t=>Math.floor((t.r+t.g+t.b)/3),fn=t=>"#"+t.r.toString(16).padStart(2,"0")+t.g.toString(16).padStart(2,"0")+t.b.toString(16).padStart(2,"0"),Ke=t=>{let e=Je(t);return{r:e,g:e,b:e}};function mn(t){let e=0;for(let n=0,o=t.length;n<o;n++){let r=t.charCodeAt(n);e=(e<<5)-e+r,e|=0}return e}const fe=(t,e,n)=>(e*n+t)*4;let bn=function(t,e,n,o){let r=t.width,a=fe(e,n,r);t.data[a]=o.r,t.data[a+1]=o.g,t.data[a+2]=o.b},xn=function(t,e,n){t.data[e]=n},kn=function(t,e,n){let o=t.width,r=fe(e,n,o);return{r:t.data[r],g:t.data[r+1],b:t.data[r+2]}};const P={getPixelDataRGB:kn,setPixelDataRGB:bn,setPixelDataRaw:xn,calc_i:fe,hashCode:mn,Rgb2Gray:Ke,RgbGrayValue:Je,RgbToHex:fn,nearestPixel:gn,nearestPixel2:pn,clamp:hn,pixelAdd:un,pixelDiff:je,hexToRgb:Ue,calculatePixelDifference:pe};function ke(t,e,n){const o=t.slice();return o[59]=e[n],o}function _e(t,e,n){const o=t.slice();return o[62]=e[n],o[63]=e,o[64]=n,o}function we(t,e,n){const o=t.slice();return o[65]=e[n],o[66]=e,o[67]=n,o}function $e(t,e,n){const o=t.slice();return o[68]=e[n],o}function ve(t,e,n){const o=t.slice();return o[71]=e[n],o}function ye(t){let e,n,o,r,a,c,d,i,l,x=t[0].width+"",k,p,m,u,$,T,_,y,it,E,J,rt;function et(b){t[28](b)}let H={text:"Pixelated"};t[0].pixelated!==void 0&&(H.checked=t[0].pixelated),$=new wt({props:H}),ft.push(()=>Rt($,"checked",et));function W(b){t[29](b)}let O={text:"Cache"};return t[0].cache!==void 0&&(O.checked=t[0].cache),y=new wt({props:O}),ft.push(()=>Rt(y,"checked",W)),{c(){e=w("div"),n=w("div"),o=w("div"),r=w("span"),r.textContent="Width",a=z(),c=w("input"),i=z(),l=w("span"),k=N(x),p=z(),m=w("div"),u=w("div"),kt($.$$.fragment),_=z(),kt(y.$$.fragment),g(r,"class","svelte-1g1m22k"),xt(c,"flex","1"),g(c,"type","range"),g(c,"min","3"),g(c,"max",d=t[0].max_width),g(c,"step","3"),g(c,"class","svelte-1g1m22k"),g(l,"class","svelte-1g1m22k"),g(o,"class","flex slider-wrapper svelte-1g1m22k"),g(u,"class","d-block"),g(m,"class","flex"),g(n,"class","flex flex-col"),g(e,"class","bg-white text-black p-2")},m(b,D){I(b,e,D),h(e,n),h(n,o),h(o,r),h(o,a),h(o,c),gt(c,t[0].width),h(o,i),h(o,l),h(l,k),h(n,p),h(n,m),h(m,u),mt($,u,null),h(u,_),mt(y,u,null),E=!0,J||(rt=[B(c,"change",t[27]),B(c,"input",t[27])],J=!0)},p(b,D){(!E||D[0]&1&&d!==(d=b[0].max_width))&&g(c,"max",d),D[0]&1&&gt(c,b[0].width),(!E||D[0]&1)&&x!==(x=b[0].width+"")&&ht(k,x);const S={};!T&&D[0]&1&&(T=!0,S.checked=b[0].pixelated,Pt(()=>T=!1)),$.$set(S);const U={};!it&&D[0]&1&&(it=!0,U.checked=b[0].cache,Pt(()=>it=!1)),y.$set(U)},i(b){E||(G($.$$.fragment,b),G(y.$$.fragment,b),E=!0)},o(b){F($.$$.fragment,b),F(y.$$.fragment,b),E=!1},d(b){b&&R(e),bt($),bt(y),J=!1,$t(rt)}}}function ze(t){let e,n,o,r,a,c,d,i,l,x,k,p,m,u,$=t[0].rubiks_scale+"",T,_,y,it,E,J,rt,et=t[0].grid_size+"",H,W,O,b;function D(A){t[30](A)}let S={text:"rubiks"};t[0].show_rubiks!==void 0&&(S.checked=t[0].show_rubiks),r=new wt({props:S}),ft.push(()=>Rt(r,"checked",D));function U(A){t[31](A)}let _t={text:"Show Grid"};return t[0].show_grid!==void 0&&(_t.checked=t[0].show_grid),d=new wt({props:_t}),ft.push(()=>Rt(d,"checked",U)),{c(){e=w("div"),n=w("div"),o=w("div"),kt(r.$$.fragment),c=z(),kt(d.$$.fragment),l=z(),x=w("div"),k=N(`Scale\r
            `),p=w("input"),m=z(),u=w("span"),T=N($),_=z(),y=w("span"),y.textContent="\xA0",it=N(`\r
            Grid Size\r
            `),E=w("input"),J=z(),rt=w("span"),H=N(et),g(o,"class","flex"),g(p,"type","range"),g(p,"max","40"),xt(y,"margin-left","10px"),g(E,"type","range"),g(E,"max","10"),g(x,"class","flex"),g(n,"class","flex flex-col"),g(e,"class","bg-white text-black p-2")},m(A,st){I(A,e,st),h(e,n),h(n,o),mt(r,o,null),h(o,c),mt(d,o,null),h(n,l),h(n,x),h(x,k),h(x,p),gt(p,t[0].rubiks_scale),h(x,m),h(x,u),h(u,T),h(x,_),h(x,y),h(x,it),h(x,E),gt(E,t[0].grid_size),h(x,J),h(x,rt),h(rt,H),W=!0,O||(b=[B(p,"change",t[32]),B(p,"input",t[32]),B(E,"change",t[33]),B(E,"input",t[33])],O=!0)},p(A,st){const V={};!a&&st[0]&1&&(a=!0,V.checked=A[0].show_rubiks,Pt(()=>a=!1)),r.$set(V);const yt={};!i&&st[0]&1&&(i=!0,yt.checked=A[0].show_grid,Pt(()=>i=!1)),d.$set(yt),st[0]&1&&gt(p,A[0].rubiks_scale),(!W||st[0]&1)&&$!==($=A[0].rubiks_scale+"")&&ht(T,$),st[0]&1&&gt(E,A[0].grid_size),(!W||st[0]&1)&&et!==(et=A[0].grid_size+"")&&ht(H,et)},i(A){W||(G(r.$$.fragment,A),G(d.$$.fragment,A),W=!0)},o(A){F(r.$$.fragment,A),F(d.$$.fragment,A),W=!1},d(A){A&&R(e),bt(r),bt(d),O=!1,$t(b)}}}function Pe(t){let e,n,o,r,a,c,d=t[0].mockup_pixel_size+"",i,l,x,k,p,m,u,$=t[0].mockup_x+"",T,_,y,it,E,J=t[0].mockup_y+"",rt,et,H;function W(D,S){return D[1].mockup_hovering?_n:wn}let O=W(t),b=O(t);return{c(){e=w("div"),n=w("div"),b.c(),o=N(`\r
\r
        Mock Up Pixel\r
        `),r=w("input"),a=z(),c=w("span"),i=N(d),l=z(),x=w("br"),k=N(`\r
        Mock Up Position\r
        `),p=w("input"),m=z(),u=w("span"),T=N($),_=z(),y=w("input"),it=z(),E=w("span"),rt=N(J),xt(n,"height","100px"),g(n,"ondragover","return false"),g(n,"id","mockup_drop_zone"),g(n,"class","bg-red-500 h-full p-4"),g(r,"type","range"),g(r,"min","1"),g(r,"max","25"),g(p,"type","range"),g(p,"min","-500"),g(p,"max","500"),g(y,"type","range"),g(y,"min","-500"),g(y,"max","500"),g(e,"class","bg-white text-black p-2")},m(D,S){I(D,e,S),h(e,n),b.m(n,null),h(e,o),h(e,r),gt(r,t[0].mockup_pixel_size),h(e,a),h(e,c),h(c,i),h(e,l),h(e,x),h(e,k),h(e,p),gt(p,t[0].mockup_x),h(e,m),h(e,u),h(u,T),h(e,_),h(e,y),gt(y,t[0].mockup_y),h(e,it),h(e,E),h(E,rt),et||(H=[B(n,"drop",t[15]),B(n,"dragenter",t[16]),B(n,"dragleave",t[17]),B(r,"change",t[34]),B(r,"input",t[34]),B(p,"change",t[35]),B(p,"input",t[35]),B(y,"change",t[36]),B(y,"input",t[36])],et=!0)},p(D,S){O!==(O=W(D))&&(b.d(1),b=O(D),b&&(b.c(),b.m(n,null))),S[0]&1&&gt(r,D[0].mockup_pixel_size),S[0]&1&&d!==(d=D[0].mockup_pixel_size+"")&&ht(i,d),S[0]&1&&gt(p,D[0].mockup_x),S[0]&1&&$!==($=D[0].mockup_x+"")&&ht(T,$),S[0]&1&&gt(y,D[0].mockup_y),S[0]&1&&J!==(J=D[0].mockup_y+"")&&ht(rt,J)},d(D){D&&R(e),b.d(),et=!1,$t(H)}}}function _n(t){let e;return{c(){e=N("Release to load file")},m(n,o){I(n,e,o)},d(n){n&&R(e)}}}function wn(t){let e;return{c(){e=N("Drop Mock Up Image here")},m(n,o){I(n,e,o)},d(n){n&&R(e)}}}function Re(t){let e,n,o,r,a,c,d,i,l,x,k,p,m,u,$,T,_,y,it,E,J;function rt(b){t[37](b)}let et={text:"Gray"};t[0].gray_scale_input!==void 0&&(et.checked=t[0].gray_scale_input),a=new wt({props:et}),ft.push(()=>Rt(a,"checked",rt));function H(b){t[38](b)}let W={text:"Nearest Gray Pixel"};t[0].gray_scale_nearest_pixel!==void 0&&(W.checked=t[0].gray_scale_nearest_pixel),k=new wt({props:W}),ft.push(()=>Rt(k,"checked",H)),$=new wt({props:{text:"No Dithering",checked:t[0].dithering==""}}),$.$on("click",t[39]),_=new wt({props:{text:"Patterned Dithering",checked:t[0].dithering=="pattern"}}),_.$on("click",t[40]);let O=t[0].dithering=="pattern"&&De(t);return E=new wt({props:{text:"Floyd Steinberg",checked:t[0].dithering=="fs"}}),E.$on("click",t[42]),{c(){e=w("div"),n=w("div"),o=w("span"),o.textContent="Input Image:",r=z(),kt(a.$$.fragment),d=z(),i=w("div"),l=w("span"),l.textContent="Nearest Pixel:",x=z(),kt(k.$$.fragment),m=z(),u=w("div"),kt($.$$.fragment),T=z(),kt(_.$$.fragment),y=z(),O&&O.c(),it=z(),kt(E.$$.fragment),g(o,"class","p-2"),g(n,"class","flex"),g(l,"class","p-2"),g(i,"class","flex"),g(u,"class","flex"),g(e,"class","bg-white text-black p-2")},m(b,D){I(b,e,D),h(e,n),h(n,o),h(n,r),mt(a,n,null),h(e,d),h(e,i),h(i,l),h(i,x),mt(k,i,null),h(e,m),h(e,u),mt($,u,null),h(u,T),mt(_,u,null),h(u,y),O&&O.m(u,null),h(u,it),mt(E,u,null),J=!0},p(b,D){const S={};!c&&D[0]&1&&(c=!0,S.checked=b[0].gray_scale_input,Pt(()=>c=!1)),a.$set(S);const U={};!p&&D[0]&1&&(p=!0,U.checked=b[0].gray_scale_nearest_pixel,Pt(()=>p=!1)),k.$set(U);const _t={};D[0]&1&&(_t.checked=b[0].dithering==""),$.$set(_t);const A={};D[0]&1&&(A.checked=b[0].dithering=="pattern"),_.$set(A),b[0].dithering=="pattern"?O?O.p(b,D):(O=De(b),O.c(),O.m(u,it)):O&&(O.d(1),O=null);const st={};D[0]&1&&(st.checked=b[0].dithering=="fs"),E.$set(st)},i(b){J||(G(a.$$.fragment,b),G(k.$$.fragment,b),G($.$$.fragment,b),G(_.$$.fragment,b),G(E.$$.fragment,b),J=!0)},o(b){F(a.$$.fragment,b),F(k.$$.fragment,b),F($.$$.fragment,b),F(_.$$.fragment,b),F(E.$$.fragment,b),J=!1},d(b){b&&R(e),bt(a),bt(k),bt($),bt(_),O&&O.d(),bt(E)}}}function De(t){let e,n,o,r=t[11],a=[];for(let c=0;c<r.length;c+=1)a[c]=Ie(ve(t,r,c));return{c(){e=w("span"),e.textContent="Matrix:",n=z();for(let c=0;c<a.length;c+=1)a[c].c();o=ue(),g(e,"class","h-10 p-2")},m(c,d){I(c,e,d),I(c,n,d);for(let i=0;i<a.length;i+=1)a[i].m(c,d);I(c,o,d)},p(c,d){if(d[0]&2049){r=c[11];let i;for(i=0;i<r.length;i+=1){const l=ve(c,r,i);a[i]?a[i].p(l,d):(a[i]=Ie(l),a[i].c(),a[i].m(o.parentNode,o))}for(;i<a.length;i+=1)a[i].d(1);a.length=r.length}},d(c){c&&R(e),c&&R(n),Lt(a,c),c&&R(o)}}}function Ie(t){let e,n=t[71].length+"",o,r,a,c;function d(){return t[41](t[71])}return{c(){e=w("button"),o=N(n),r=z(),g(e,"class","h-10 p-2 rounded-lg border-solid border-2"),M(e,"bg-green-600",t[0].matrix==t[71])},m(i,l){I(i,e,l),h(e,o),h(e,r),a||(c=B(e,"click",d),a=!0)},p(i,l){t=i,l[0]&2049&&M(e,"bg-green-600",t[0].matrix==t[71])},d(i){i&&R(e),a=!1,c()}}}function Ge(t){let e,n,o,r,a,c=t[10],d=[];for(let p=0;p<c.length;p+=1)d[p]=Ee($e(t,c,p));const i=p=>F(d[p],1,1,()=>{d[p]=null});let l=t[0].individual_pallette_colors,x=[];for(let p=0;p<l.length;p+=1)x[p]=Se(we(t,l,p));const k=p=>F(x[p],1,1,()=>{x[p]=null});return{c(){e=w("div"),n=w("div");for(let p=0;p<d.length;p+=1)d[p].c();o=z(),r=w("div");for(let p=0;p<x.length;p+=1)x[p].c();g(n,"class","flex"),g(e,"class","bg-white text-black p-2"),g(r,"class","flex")},m(p,m){I(p,e,m),h(e,n);for(let u=0;u<d.length;u+=1)d[u].m(n,null);I(p,o,m),I(p,r,m);for(let u=0;u<x.length;u+=1)x[u].m(r,null);a=!0},p(p,m){if(m[0]&263169){c=p[10];let u;for(u=0;u<c.length;u+=1){const $=$e(p,c,u);d[u]?(d[u].p($,m),G(d[u],1)):(d[u]=Ee($),d[u].c(),G(d[u],1),d[u].m(n,null))}for(It(),u=c.length;u<d.length;u+=1)i(u);Gt()}if(m[0]&1){l=p[0].individual_pallette_colors;let u;for(u=0;u<l.length;u+=1){const $=we(p,l,u);x[u]?(x[u].p($,m),G(x[u],1)):(x[u]=Se($),x[u].c(),G(x[u],1),x[u].m(r,null))}for(It(),u=l.length;u<x.length;u+=1)k(u);Gt()}},i(p){if(!a){for(let m=0;m<c.length;m+=1)G(d[m]);for(let m=0;m<l.length;m+=1)G(x[m]);a=!0}},o(p){d=d.filter(Boolean);for(let m=0;m<d.length;m+=1)F(d[m]);x=x.filter(Boolean);for(let m=0;m<x.length;m+=1)F(x[m]);a=!1},d(p){p&&R(e),Lt(d,p),p&&R(o),p&&R(r),Lt(x,p)}}}function Ee(t){let e,n;function o(...r){return t[43](t[68],...r)}return e=new dn({props:{selected:t[0].pallette,name:t[68].name,color:t[68].colors}}),e.$on("click",o),{c(){kt(e.$$.fragment)},m(r,a){mt(e,r,a),n=!0},p(r,a){t=r;const c={};a[0]&1&&(c.selected=t[0].pallette),e.$set(c)},i(r){n||(G(e.$$.fragment,r),n=!0)},o(r){F(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}function Se(t){let e,n,o;function r(c){t[44](c,t[65])}let a={text:t[65].color,bgcolor:t[65].on?t[65].color:"white"};return t[65].on!==void 0&&(a.checked=t[65].on),e=new wt({props:a}),ft.push(()=>Rt(e,"checked",r)),{c(){kt(e.$$.fragment)},m(c,d){mt(e,c,d),o=!0},p(c,d){t=c;const i={};d[0]&1&&(i.text=t[65].color),d[0]&1&&(i.bgcolor=t[65].on?t[65].color:"white"),!n&&d[0]&1&&(n=!0,i.checked=t[65].on,Pt(()=>n=!1)),e.$set(i)},i(c){o||(G(e.$$.fragment,c),o=!0)},o(c){F(e.$$.fragment,c),o=!1},d(c){bt(e,c)}}}function Oe(t){let e,n,o,r,a,c,d,i,l,x,k,p=t[0].dithering=="pattern"&&Be(t),m=t[0].dithering=="fs"&&Ae(t);return{c(){e=w("code"),n=N(t[9]),o=z(),r=w("input"),c=z(),p&&p.c(),d=z(),m&&m.c(),i=ue(),g(r,"type","range"),g(r,"min","-1"),g(r,"max",a=t[1].total_pixels),g(r,"step","1")},m(u,$){I(u,e,$),h(e,n),I(u,o,$),I(u,r,$),gt(r,t[0].debug_range),I(u,c,$),p&&p.m(u,$),I(u,d,$),m&&m.m(u,$),I(u,i,$),l=!0,x||(k=[B(r,"change",t[45]),B(r,"input",t[45])],x=!0)},p(u,$){(!l||$[0]&512)&&ht(n,u[9]),(!l||$[0]&2&&a!==(a=u[1].total_pixels))&&g(r,"max",a),$[0]&1&&gt(r,u[0].debug_range),u[0].dithering=="pattern"?p?p.p(u,$):(p=Be(u),p.c(),p.m(d.parentNode,d)):p&&(p.d(1),p=null),u[0].dithering=="fs"?m?(m.p(u,$),$[0]&1&&G(m,1)):(m=Ae(u),m.c(),G(m,1),m.m(i.parentNode,i)):m&&(It(),F(m,1,1,()=>{m=null}),Gt())},i(u){l||(G(m),l=!0)},o(u){F(m),l=!1},d(u){u&&R(e),u&&R(o),u&&R(r),u&&R(c),p&&p.d(u),u&&R(d),m&&m.d(u),u&&R(i),x=!1,$t(k)}}}function Be(t){let e,n=t[0].matrix,o=[];for(let r=0;r<n.length;r+=1)o[r]=Te(ke(t,n,r));return{c(){for(let r=0;r<o.length;r+=1)o[r].c();e=ue()},m(r,a){for(let c=0;c<o.length;c+=1)o[c].m(r,a);I(r,e,a)},p(r,a){if(a[0]&1){n=r[0].matrix;let c;for(c=0;c<n.length;c+=1){const d=ke(r,n,c);o[c]?o[c].p(d,a):(o[c]=Te(d),o[c].c(),o[c].m(e.parentNode,e))}for(;c<o.length;c+=1)o[c].d(1);o.length=n.length}},d(r){Lt(o,r),r&&R(e)}}}function Ne(t){let e,n,o=t[62]+"",r,a,c;function d(){t[46].call(e,t[63],t[64])}return{c(){e=w("input"),n=z(),r=N(o),g(e,"type","range"),g(e,"step","0.01"),g(e,"max","1.0"),g(e,"min","0.0")},m(i,l){I(i,e,l),gt(e,t[62]),I(i,n,l),I(i,r,l),a||(c=[B(e,"change",d),B(e,"input",d)],a=!0)},p(i,l){t=i,l[0]&1&&gt(e,t[62]),l[0]&1&&o!==(o=t[62]+"")&&ht(r,o)},d(i){i&&R(e),i&&R(n),i&&R(r),a=!1,$t(c)}}}function Te(t){let e,n,o=t[59],r=[];for(let a=0;a<o.length;a+=1)r[a]=Ne(_e(t,o,a));return{c(){e=w("div");for(let a=0;a<r.length;a+=1)r[a].c();n=z(),g(e,"class","flex")},m(a,c){I(a,e,c);for(let d=0;d<r.length;d+=1)r[d].m(e,null);h(e,n)},p(a,c){if(c[0]&1){o=a[59];let d;for(d=0;d<o.length;d+=1){const i=_e(a,o,d);r[d]?r[d].p(i,c):(r[d]=Ne(i),r[d].c(),r[d].m(e,n))}for(;d<r.length;d+=1)r[d].d(1);r.length=o.length}},d(a){a&&R(e),Lt(r,a)}}}function Ae(t){let e,n,o;function r(c){t[47](c)}let a={text:"Cap"};return t[0].cap!==void 0&&(a.checked=t[0].cap),e=new wt({props:a}),ft.push(()=>Rt(e,"checked",r)),{c(){kt(e.$$.fragment)},m(c,d){mt(e,c,d),o=!0},p(c,d){const i={};!n&&d[0]&1&&(n=!0,i.checked=c[0].cap,Pt(()=>n=!1)),e.$set(i)},i(c){o||(G(e.$$.fragment,c),o=!0)},o(c){F(e.$$.fragment,c),o=!1},d(c){bt(e,c)}}}function Ce(t){let e;return{c(){e=w("div"),e.textContent="Drop to load image",g(e,"class","rounded-lg border-solid border-2 p-8 text-white text-center m-auto w-fit")},m(n,o){I(n,e,o)},d(n){n&&R(e)}}}function Le(t){let e,n=t[1].resizedwidth+"",o,r,a=t[1].resizedheight+"",c,d,i=t[1].resizedwidth*t[1].resizedheight+"",l,x,k=t[1].resizedheight*t[1].resizedwidth/9+"",p,m,u,$,T;return{c(){e=N("Image Size: "),o=N(n),r=N(" x "),c=N(a),d=N(" = "),l=N(i),x=N(`\r
      | Total Rubiks: `),p=N(k),m=N(`\r
\r
      WIDTH: `),u=N(t[2]),$=N(`\r
      HEIGHT: `),T=N(t[4])},m(_,y){I(_,e,y),I(_,o,y),I(_,r,y),I(_,c,y),I(_,d,y),I(_,l,y),I(_,x,y),I(_,p,y),I(_,m,y),I(_,u,y),I(_,$,y),I(_,T,y)},p(_,y){y[0]&2&&n!==(n=_[1].resizedwidth+"")&&ht(o,n),y[0]&2&&a!==(a=_[1].resizedheight+"")&&ht(c,a),y[0]&2&&i!==(i=_[1].resizedwidth*_[1].resizedheight+"")&&ht(l,i),y[0]&2&&k!==(k=_[1].resizedheight*_[1].resizedwidth/9+"")&&ht(p,k),y[0]&4&&ht(u,_[2]),y[0]&16&&ht(T,_[4])},d(_){_&&R(e),_&&R(o),_&&R(r),_&&R(c),_&&R(d),_&&R(l),_&&R(x),_&&R(p),_&&R(m),_&&R(u),_&&R($),_&&R(T)}}}function $n(t){let e,n,o,r,a,c,d,i,l,x,k,p,m,u,$,T,_,y,it,E,J,rt,et,H,W,O,b,D,S,U,_t,A,st,V,yt,Ot,Ht,zt,ot,Bt,Nt,jt,Ut,K,Tt,At,Jt,Kt,C,Mt,Vt;function re(s){t[26](s)}let Xt={text:"debug"};t[1].show_debug!==void 0&&(Xt.checked=t[1].show_debug),_=new wt({props:Xt}),ft.push(()=>Rt(_,"checked",re));let X=t[1].current=="img"&&ye(t),Q=t[1].current=="rubiks"&&ze(t),dt=t[1].current=="mockup"&&Pe(t),Y=t[1].current=="processing"&&Re(t),Z=t[1].current=="pallette"&&Ge(t),tt=t[1].show_debug&&Oe(t),pt=!t[3]&&t[1].hovering&&Ce(),ut=t[1].resizedheight&&t[1].resizedwidth&&Le(t);return{c(){e=w("main"),n=w("div"),o=w("div"),r=w("div"),a=w("button"),a.textContent="Output Image",c=z(),d=w("button"),d.textContent="Pallette",i=z(),l=w("button"),l.textContent="Processing",x=z(),k=w("button"),k.textContent="Rubiks",p=z(),m=w("button"),m.textContent="Mock Up",u=z(),$=w("div"),T=z(),kt(_.$$.fragment),it=z(),X&&X.c(),E=z(),Q&&Q.c(),J=z(),dt&&dt.c(),rt=z(),Y&&Y.c(),et=z(),Z&&Z.c(),H=z(),tt&&tt.c(),W=z(),O=w("div"),b=w("div"),D=w("div"),S=w("div"),U=w("canvas"),st=z(),V=w("canvas"),Ht=z(),zt=w("div"),ot=w("canvas"),Ut=z(),K=w("canvas"),Jt=z(),pt&&pt.c(),Kt=z(),ut&&ut.c(),g(a,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),M(a,"bg-gray-400",t[1].current=="img"),g(d,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),M(d,"bg-gray-400",t[1].current=="pallette"),g(l,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),M(l,"bg-gray-400",t[1].current=="processing"),g(k,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),M(k,"bg-gray-400",t[1].current=="rubiks"),g(m,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),M(m,"bg-gray-400",t[1].current=="mockup"),g($,"class","spacer svelte-1g1m22k"),g(r,"class","flex"),g(o,"class","bg-white text-black p-2"),g(U,"class","small svelte-1g1m22k"),g(U,"id","canvas"),g(U,"width",_t=t[1].canvaswidth),g(U,"height",A=t[1].canvasheight),M(U,"shown",t[3]),M(U,"pixelated",t[0].pixelated),g(V,"id","output_canvas"),g(V,"width",yt=t[1].resizedwidth),g(V,"height",Ot=t[1].resizedheight),g(V,"class","svelte-1g1m22k"),M(V,"small",t[0].show_rubiks),M(V,"shown",t[3]),M(V,"pixelated",t[0].pixelated),xt(ot,"position","absolute"),g(ot,"id","bgcanvas"),g(ot,"width",Bt=t[1].mockupwidth),g(ot,"height",Nt=t[1].mockupheight),g(ot,"class","svelte-1g1m22k"),ie(()=>t[51].call(ot)),M(ot,"shown",t[0].has_mockup),xt(K,"position","absolute"),xt(K,"top",t[4]/2-t[1].resizedheight*t[0].mockup_pixel_size*t[2]/t[1].mockupwidth/2+t[0].mockup_y*t[2]/t[1].mockupwidth+"px"),xt(K,"left",t[2]/2-t[1].resizedwidth*t[0].mockup_pixel_size*t[2]/t[1].mockupwidth/2+t[0].mockup_x*t[2]/t[1].mockupwidth+"px"),xt(K,"width",t[1].resizedwidth*t[0].mockup_pixel_size*t[2]/t[1].mockupwidth+"px"),g(K,"id","rubiks_canvas"),g(K,"width",Tt=t[1].resizedwidth*t[0].rubiks_scale),g(K,"height",At=t[1].resizedheight*t[0].rubiks_scale),g(K,"class","svelte-1g1m22k"),M(K,"shown",t[3]&&t[0].show_rubiks),M(K,"pixelated",t[0].pixelated),xt(zt,"position","relative"),g(zt,"id","canvas_wrapper"),g(S,"class","flex-col"),g(D,"class","flex"),g(b,"ondragover","return false"),g(b,"id","drop_zone"),g(b,"class","bg-white h-full"),g(O,"class","bg-green-800 grow justify-center"),g(n,"class","flex flex-col bg-red-800 h-screen")},m(s,f){I(s,e,f),h(e,n),h(n,o),h(o,r),h(r,a),h(r,c),h(r,d),h(r,i),h(r,l),h(r,x),h(r,k),h(r,p),h(r,m),h(r,u),h(r,$),h(r,T),mt(_,r,null),h(n,it),X&&X.m(n,null),h(n,E),Q&&Q.m(n,null),h(n,J),dt&&dt.m(n,null),h(n,rt),Y&&Y.m(n,null),h(n,et),Z&&Z.m(n,null),h(n,H),tt&&tt.m(n,null),h(n,W),h(n,O),h(O,b),h(b,D),h(D,S),h(S,U),t[48](U),h(S,st),h(S,V),t[49](V),h(S,Ht),h(S,zt),h(zt,ot),t[50](ot),jt=tn(ot,t[51].bind(ot)),h(zt,Ut),h(zt,K),t[52](K),h(b,Jt),pt&&pt.m(b,null),h(n,Kt),ut&&ut.m(n,null),C=!0,Mt||(Vt=[B(a,"click",t[21]),B(d,"click",t[22]),B(l,"click",t[23]),B(k,"click",t[24]),B(m,"click",t[25]),B(b,"drop",t[12]),B(b,"dragenter",t[13]),B(b,"dragleave",t[14])],Mt=!0)},p(s,f){(!C||f[0]&2)&&M(a,"bg-gray-400",s[1].current=="img"),(!C||f[0]&2)&&M(d,"bg-gray-400",s[1].current=="pallette"),(!C||f[0]&2)&&M(l,"bg-gray-400",s[1].current=="processing"),(!C||f[0]&2)&&M(k,"bg-gray-400",s[1].current=="rubiks"),(!C||f[0]&2)&&M(m,"bg-gray-400",s[1].current=="mockup");const v={};!y&&f[0]&2&&(y=!0,v.checked=s[1].show_debug,Pt(()=>y=!1)),_.$set(v),s[1].current=="img"?X?(X.p(s,f),f[0]&2&&G(X,1)):(X=ye(s),X.c(),G(X,1),X.m(n,E)):X&&(It(),F(X,1,1,()=>{X=null}),Gt()),s[1].current=="rubiks"?Q?(Q.p(s,f),f[0]&2&&G(Q,1)):(Q=ze(s),Q.c(),G(Q,1),Q.m(n,J)):Q&&(It(),F(Q,1,1,()=>{Q=null}),Gt()),s[1].current=="mockup"?dt?dt.p(s,f):(dt=Pe(s),dt.c(),dt.m(n,rt)):dt&&(dt.d(1),dt=null),s[1].current=="processing"?Y?(Y.p(s,f),f[0]&2&&G(Y,1)):(Y=Re(s),Y.c(),G(Y,1),Y.m(n,et)):Y&&(It(),F(Y,1,1,()=>{Y=null}),Gt()),s[1].current=="pallette"?Z?(Z.p(s,f),f[0]&2&&G(Z,1)):(Z=Ge(s),Z.c(),G(Z,1),Z.m(n,H)):Z&&(It(),F(Z,1,1,()=>{Z=null}),Gt()),s[1].show_debug?tt?(tt.p(s,f),f[0]&2&&G(tt,1)):(tt=Oe(s),tt.c(),G(tt,1),tt.m(n,W)):tt&&(It(),F(tt,1,1,()=>{tt=null}),Gt()),(!C||f[0]&2&&_t!==(_t=s[1].canvaswidth))&&g(U,"width",_t),(!C||f[0]&2&&A!==(A=s[1].canvasheight))&&g(U,"height",A),(!C||f[0]&8)&&M(U,"shown",s[3]),(!C||f[0]&1)&&M(U,"pixelated",s[0].pixelated),(!C||f[0]&2&&yt!==(yt=s[1].resizedwidth))&&g(V,"width",yt),(!C||f[0]&2&&Ot!==(Ot=s[1].resizedheight))&&g(V,"height",Ot),(!C||f[0]&1)&&M(V,"small",s[0].show_rubiks),(!C||f[0]&8)&&M(V,"shown",s[3]),(!C||f[0]&1)&&M(V,"pixelated",s[0].pixelated),(!C||f[0]&2&&Bt!==(Bt=s[1].mockupwidth))&&g(ot,"width",Bt),(!C||f[0]&2&&Nt!==(Nt=s[1].mockupheight))&&g(ot,"height",Nt),(!C||f[0]&1)&&M(ot,"shown",s[0].has_mockup),(!C||f[0]&23)&&xt(K,"top",s[4]/2-s[1].resizedheight*s[0].mockup_pixel_size*s[2]/s[1].mockupwidth/2+s[0].mockup_y*s[2]/s[1].mockupwidth+"px"),(!C||f[0]&7)&&xt(K,"left",s[2]/2-s[1].resizedwidth*s[0].mockup_pixel_size*s[2]/s[1].mockupwidth/2+s[0].mockup_x*s[2]/s[1].mockupwidth+"px"),(!C||f[0]&7)&&xt(K,"width",s[1].resizedwidth*s[0].mockup_pixel_size*s[2]/s[1].mockupwidth+"px"),(!C||f[0]&3&&Tt!==(Tt=s[1].resizedwidth*s[0].rubiks_scale))&&g(K,"width",Tt),(!C||f[0]&3&&At!==(At=s[1].resizedheight*s[0].rubiks_scale))&&g(K,"height",At),(!C||f[0]&9)&&M(K,"shown",s[3]&&s[0].show_rubiks),(!C||f[0]&1)&&M(K,"pixelated",s[0].pixelated),!s[3]&&s[1].hovering?pt||(pt=Ce(),pt.c(),pt.m(b,null)):pt&&(pt.d(1),pt=null),s[1].resizedheight&&s[1].resizedwidth?ut?ut.p(s,f):(ut=Le(s),ut.c(),ut.m(n,null)):ut&&(ut.d(1),ut=null)},i(s){C||(G(_.$$.fragment,s),G(X),G(Q),G(Y),G(Z),G(tt),C=!0)},o(s){F(_.$$.fragment,s),F(X),F(Q),F(Y),F(Z),F(tt),C=!1},d(s){s&&R(e),bt(_),X&&X.d(),Q&&Q.d(),dt&&dt.d(),Y&&Y.d(),Z&&Z.d(),tt&&tt.d(),t[48](null),t[49](null),t[50](null),jt(),t[52](null),pt&&pt.d(),ut&&ut.d(),Mt=!1,$t(Vt)}}}function vn(t,e,n){let o,r,a=!1,c=[{name:"rbk",colors:"#013082,#BB2328,#01B351,#FE8F25,#F5FF42,#ECF3F6"},{name:"rbkng",colors:"#013082,#BB2328,#FE8F25,#F5FF42,#ECF3F6"},{name:"b&w",colors:"#000,#fff"},{name:"gray",colors:"#000,#666,#fff"},{name:"grayscale",colors:"#000,#111,#222,#333,#444,#555,#666,#777,#888,#999,#aaa,#bbb,#ccc,#ddd,#eee,#fff"},{name:"rgb",colors:"#000,#f00,#0f0,#00f,#fff"},{name:"cmyk",colors:"#000,#0ff,#f0f,#ff0,#fff"}],d=[[[0/4,2/4],[3/4,1/4]],[[0/16,8/16,2/16,10/16],[12/16,4/16,14/16,6/16],[3/16,11/16,1/16,9/16],[15/16,7/16,13/16,5/16]]],i={loadedfile:"",cache:!0,cap:!1,pixelated:!0,has_mockup:!1,mockup_pixel_size:1,mockup_x:0,mockup_y:0,width:0,height:0,dithering:"pattern",max_width:600,show_rubiks:!0,show_grid:!1,rubiks_scale:8,gray_scale_input:!1,gray_scale_nearest_pixel:!1,grid_size:2,pallette:c[0].colors,individual_pallette_colors:[],debug_range:-1,matrix:d[0]},l={current:"",hovering:!1,mockup_hovering:!1,mockupheight:100,mockupwidth:100,show_debug:!1,resizedwidth:0,resizedheight:0,total_pixels:0,canvaswidth:100,canvasheight:100},x,k,p,m,u,$,T="",_={},y=function(s){s.preventDefault();let f=s;if(f.dataTransfer.items)if(f.dataTransfer.items.length==1){let v=f.dataTransfer.items[0];if(v.kind==="file"){const nt=v.getAsFile();b(nt)}else console.log("kind is not file, but: "+v.kind)}else n(9,r="Error: can only load one file");n(1,l.hovering=!1,l)},it=function(){console.log("drag enter"),n(1,l.hovering=!0,l)},E=function(){n(1,l.hovering=!1,l)},J=function(s){s.preventDefault();let f=s;if(f.dataTransfer.items)if(f.dataTransfer.items.length==1){let v=f.dataTransfer.items[0];if(v.kind==="file"){const nt=v.getAsFile();n(0,i.has_mockup=!0,i),O(nt)}else console.log("kind is not file, but: "+v.kind)}else n(9,r="Error: can only load one file");n(1,l.mockup_hovering=!1,l)},rt=function(){console.log("drag enter"),n(1,l.mockup_hovering=!0,l)},et=function(){n(1,l.mockup_hovering=!1,l)},H,W,O=function(s){let f=m.getContext("2d");W=new Image,W.onload=async function(){await Zt(),n(1,l.mockupheight=W.height,l),n(1,l.mockupwidth=W.width,l),await Zt(),f.drawImage(W,0,0,W.width,W.height)},W.src=URL.createObjectURL(s)},b=function(s){n(0,i.loadedfile=s.name,i);let f=p.getContext("2d");H=new Image,H.onload=async function(){n(1,l.canvasheight=H.height,l),n(1,l.canvaswidth=H.width,l),n(0,i.width=Math.min(99,l.canvaswidth),i),n(0,i.max_width=Math.min(l.canvaswidth,999),i),n(3,a=!0),_={},await Zt(),f.drawImage(H,0,0,H.width,H.height)},H.src=URL.createObjectURL(s)},D=function(s){n(0,i.pallette=s,i),n(0,i.individual_pallette_colors=[],i),s.split(",").forEach(f=>{i.individual_pallette_colors.push({color:f,on:!0})})},S=function(s){l.current==s?n(1,l.current="",l):n(1,l.current=s,l)};nn(async()=>{if(!i.width){console.log("no width, ending here");return}if(!a){console.log("no image loaded, ending here");return}if(!H){console.log("originalImage is empty","ending here");return}let s=l.canvasheight/l.canvaswidth*i.width;if(n(0,i.height=s,i),n(1,l.resizedwidth=parseInt(i.width/3)*3,l),n(1,l.resizedheight=parseInt(s/3)*3,l),n(1,l.total_pixels=l.resizedheight*l.resizedwidth,l),await Zt(),s<1){console.log("height is less than 1","ending here");return}if(T=P.hashCode(JSON.stringify(o)),i.cache&&T&&_[T]){console.log("found",o.loadedfile,T,"from cache");let f=u.getContext("2d"),v=_[T].data,nt=new ImageData(v.data,v.width,v.height);f.putImageData(nt,0,0)}else{console.log("GENERATING IMAGE",JSON.stringify(o),T);let f=u.getContext("2d");f.drawImage(H,0,0,l.resizedwidth,l.resizedheight);let v=f.getImageData(0,0,l.resizedwidth,l.resizedheight);if(i.gray_scale_input)for(let L=0,lt=0;L<v.height;L++)for(let j=0;j<v.width;j++,lt+=4){let Ct=P.getPixelDataRGB(v,j,L),vt=Math.round((Ct.r+Ct.g+Ct.b)/3);P.setPixelDataRaw(v,lt,vt),P.setPixelDataRaw(v,lt+1,vt),P.setPixelDataRaw(v,lt+2,vt)}let nt=i.pallette;i.individual_pallette_colors.length&&(nt=i.individual_pallette_colors.filter(L=>L.on).map(L=>L.color).join(","));let Ve=nt.split(",").length,Qt=nt.split(",");Qt.forEach((L,lt)=>{Qt[lt]=P.hexToRgb(L)});for(let L=0,lt=0;L<v.height;L++)for(let j=0;j<v.width;j++,lt+=4){let Ct=P.getPixelDataRGB(v,j,L),vt=P.nearestPixel2(Ct,Qt,i.gray_scale_nearest_pixel);if(i.dithering=="")P.setPixelDataRaw(v,lt,vt.r),P.setPixelDataRaw(v,lt+1,vt.g),P.setPixelDataRaw(v,lt+2,vt.b);else if(i.dithering=="fs"){P.setPixelDataRaw(v,lt,vt.r),P.setPixelDataRaw(v,lt+1,vt.g),P.setPixelDataRaw(v,lt+2,vt.b);let q=P.pixelDiff(Ct,vt);if(j<v.width-1){let ct=P.getPixelDataRGB(v,j+1,L);i.cap?P.setPixelDataRGB(v,j+1,L,{r:P.clamp(0,255,ct.r+q.r*7/16),g:P.clamp(0,255,ct.g+q.g*7/16),b:P.clamp(0,255,ct.b+q.b*7/16)}):P.setPixelDataRGB(v,j+1,L,{r:ct.r+q.r*7/16,g:ct.g+q.g*7/16,b:ct.b+q.b*7/16})}if(L<v.height-1){if(j>0){let at=P.getPixelDataRGB(v,j-1,L+1);i.cap?P.setPixelDataRGB(v,j-1,L+1,{r:P.clamp(0,255,at.r+q.r*3/16),g:P.clamp(0,255,at.g+q.g*3/16),b:P.clamp(0,255,at.b+q.b*3/16)}):P.setPixelDataRGB(v,j-1,L+1,{r:at.r+q.r*3/16,g:at.g+q.g*3/16,b:at.b+q.b*3/16})}let ct=P.getPixelDataRGB(v,j,L+1);if(i.cap?P.setPixelDataRGB(v,j,L+1,{r:P.clamp(0,255,ct.r+q.r*5/16),g:P.clamp(0,255,ct.g+q.g*5/16),b:P.clamp(0,255,ct.b+q.b*5/16)}):P.setPixelDataRGB(v,j,L+1,{r:ct.r+q.r*5/16,g:ct.g+q.g*5/16,b:ct.b+q.b*5/16}),j<v.width-1){let at=P.getPixelDataRGB(v,j+1,L+1);i.cap?P.setPixelDataRGB(v,j+1,L+1,{r:P.clamp(0,255,at.r+q.r*1/16),g:P.clamp(0,255,at.g+q.g*1/16),b:P.clamp(0,255,at.b+q.b*1/16)}):P.setPixelDataRGB(v,j+1,L+1,{r:at.r+q.r*1/16,g:at.g+q.g*1/16,b:at.b+q.b*1/16})}}}else if(i.dithering=="pattern"){let q=P.getPixelDataRGB(v,j,L),ct=255/Ve*(i.matrix[j%i.matrix[0].length][L%i.matrix.length]-.5),at=P.nearestPixel2({r:q.r+ct,g:q.g+ct,b:q.b+ct},Qt,i.gray_scale_nearest_pixel);P.setPixelDataRaw(v,lt,at.r),P.setPixelDataRaw(v,lt+1,at.g),P.setPixelDataRaw(v,lt+2,at.b)}}if(f.putImageData(v,0,0),i.cache){let L=new ImageData(new Uint8ClampedArray(v.data),v.width,v.height);console.log("adding",T,"to cache"),_[T]={data:L,params:Object.assign({},o),config:Object.assign({},i)}}}if(i.show_rubiks){let f=$.getContext("2d"),v=u.getContext("2d").getImageData(0,0,l.resizedwidth,l.resizedheight);if(f.imageSmoothingEnabled=!1,f.drawImage(u,0,0,l.resizedwidth*i.rubiks_scale,l.resizedheight*i.rubiks_scale),i.show_grid&&i.grid_size>0){f.lineWidth=i.grid_size,f.strokeStyle="#000000";for(let nt=0;nt<v.height;nt++)f.beginPath(),f.moveTo(0,nt*i.rubiks_scale),f.lineTo(v.width*i.rubiks_scale,nt*i.rubiks_scale),f.stroke();for(let nt=0;nt<v.width;nt++)f.beginPath(),f.moveTo(nt*i.rubiks_scale,0),f.lineTo(nt*i.rubiks_scale,v.height*i.rubiks_scale),f.stroke()}}});const U=()=>{S("img")},_t=()=>{S("pallette")},A=()=>{S("processing")},st=()=>{S("rubiks")},V=()=>{S("mockup")};function yt(s){t.$$.not_equal(l.show_debug,s)&&(l.show_debug=s,n(1,l))}function Ot(){i.width=Dt(this.value),n(0,i)}function Ht(s){t.$$.not_equal(i.pixelated,s)&&(i.pixelated=s,n(0,i))}function zt(s){t.$$.not_equal(i.cache,s)&&(i.cache=s,n(0,i))}function ot(s){t.$$.not_equal(i.show_rubiks,s)&&(i.show_rubiks=s,n(0,i))}function Bt(s){t.$$.not_equal(i.show_grid,s)&&(i.show_grid=s,n(0,i))}function Nt(){i.rubiks_scale=Dt(this.value),n(0,i)}function jt(){i.grid_size=Dt(this.value),n(0,i)}function Ut(){i.mockup_pixel_size=Dt(this.value),n(0,i)}function K(){i.mockup_x=Dt(this.value),n(0,i)}function Tt(){i.mockup_y=Dt(this.value),n(0,i)}function At(s){t.$$.not_equal(i.gray_scale_input,s)&&(i.gray_scale_input=s,n(0,i))}function Jt(s){t.$$.not_equal(i.gray_scale_nearest_pixel,s)&&(i.gray_scale_nearest_pixel=s,n(0,i))}const Kt=()=>n(0,i.dithering="",i),C=()=>n(0,i.dithering="pattern",i),Mt=s=>{n(0,i.matrix=s,i)},Vt=()=>n(0,i.dithering="fs",i),re=(s,f,v)=>{D(s.colors)};function Xt(s,f){t.$$.not_equal(f.on,s)&&(f.on=s,n(0,i))}function X(){i.debug_range=Dt(this.value),n(0,i)}function Q(s,f){s[f]=Dt(this.value),n(0,i)}function dt(s){t.$$.not_equal(i.cap,s)&&(i.cap=s,n(0,i))}function Y(s){ft[s?"unshift":"push"](()=>{p=s,n(5,p)})}function Z(s){ft[s?"unshift":"push"](()=>{u=s,n(7,u)})}function tt(s){ft[s?"unshift":"push"](()=>{m=s,n(6,m)})}function pt(){k=this.clientHeight,x=this.clientWidth,n(4,k),n(2,x)}function ut(s){ft[s?"unshift":"push"](()=>{$=s,n(8,$)})}return t.$$.update=()=>{t.$$.dirty[0]&1&&n(20,o={loadedfile:i.loadedfile,width:i.width,height:i.height,dithering:i.dithering,gray_scale_input:i.gray_scale_input,gray_scale_nearest_pixel:i.gray_scale_nearest_pixel,pallette:i.pallette,individual_pallette_colors:i.individual_pallette_colors,matrix:i.matrix}),t.$$.dirty[0]&1048583&&n(9,r=("UI = "+JSON.stringify(l)+`
params: `+JSON.stringify(o)+`
CONFIG:`+JSON.stringify(i)+"CLIENT WIDTH:"+x).replaceAll(",",", "))},[i,l,x,a,k,p,m,u,$,r,c,d,y,it,E,J,rt,et,D,S,o,U,_t,A,st,V,yt,Ot,Ht,zt,ot,Bt,Nt,jt,Ut,K,Tt,At,Jt,Kt,C,Mt,Vt,re,Xt,X,Q,dt,Y,Z,tt,pt,ut]}class yn extends ge{constructor(e){super(),he(this,e,vn,$n,de,{},null,[-1,-1,-1])}}new yn({target:document.getElementById("app")});
