(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function l(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=l(n);fetch(n.href,o)}})();function Ue(){}function tl(e){return e()}function Rt(){return Object.create(null)}function Be(e){e.forEach(tl)}function bl(e){return typeof e=="function"}function zt(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function kl(e){return Object.keys(e).length===0}function Bt(e){return e==null?"":e}function u(e,t){e.appendChild(t)}function E(e,t,l){e.insertBefore(t,l||null)}function I(e){e.parentNode.removeChild(e)}function Ke(e,t){for(let l=0;l<e.length;l+=1)e[l]&&e[l].d(t)}function m(e){return document.createElement(e)}function H(e){return document.createTextNode(e)}function v(){return H(" ")}function yt(){return H("")}function T(e,t,l,r){return e.addEventListener(t,l,r),()=>e.removeEventListener(t,l,r)}function f(e,t,l){l==null?e.removeAttribute(t):e.getAttribute(t)!==l&&e.setAttribute(t,l)}function Le(e){return e===""?null:+e}function wl(e){return Array.from(e.childNodes)}function ye(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function ze(e,t){e.value=t==null?"":t}function X(e,t,l,r){l===null?e.style.removeProperty(t):e.style.setProperty(t,l,r?"important":"")}let ut;function vl(){if(ut===void 0){ut=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{ut=!0}}return ut}function zl(e,t){getComputedStyle(e).position==="static"&&(e.style.position="relative");const r=m("iframe");r.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),r.setAttribute("aria-hidden","true"),r.tabIndex=-1;const n=vl();let o;return n?(r.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=T(window,"message",a=>{a.source===r.contentWindow&&t()})):(r.src="about:blank",r.onload=()=>{o=T(r.contentWindow,"resize",t)}),u(e,r),()=>{(n||o&&r.contentWindow)&&o(),I(r)}}function A(e,t,l){e.classList[l?"add":"remove"](t)}let $e;function xe(e){$e=e}function yl(){if(!$e)throw new Error("Function called outside component initialization");return $e}function Cl(e){yl().$$.after_update.push(e)}function ll(e,t){const l=e.$$.callbacks[t.type];l&&l.slice().forEach(r=>r.call(this,t))}const Ze=[],pe=[],dt=[],kt=[],il=Promise.resolve();let wt=!1;function nl(){wt||(wt=!0,il.then(rl))}function Ve(){return nl(),il}function gt(e){dt.push(e)}function Qe(e){kt.push(e)}const pt=new Set;let ft=0;function rl(){const e=$e;do{for(;ft<Ze.length;){const t=Ze[ft];ft++,xe(t),Dl(t.$$)}for(xe(null),Ze.length=0,ft=0;pe.length;)pe.pop()();for(let t=0;t<dt.length;t+=1){const l=dt[t];pt.has(l)||(pt.add(l),l())}dt.length=0}while(Ze.length);for(;kt.length;)kt.pop()();wt=!1,pt.clear(),xe(e)}function Dl(e){if(e.fragment!==null){e.update(),Be(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(gt)}}const _t=new Set;let qe;function Ne(){qe={r:0,c:[],p:qe}}function Oe(){qe.r||Be(qe.c),qe=qe.p}function M(e,t){e&&e.i&&(_t.delete(e),e.i(t))}function W(e,t,l,r){if(e&&e.o){if(_t.has(e))return;_t.add(e),qe.c.push(()=>{_t.delete(e),r&&(l&&e.d(1),r())}),e.o(t)}else r&&r()}function Xe(e,t,l){const r=e.$$.props[t];r!==void 0&&(e.$$.bound[r]=l,l(e.$$.ctx[r]))}function Se(e){e&&e.c()}function Ie(e,t,l,r){const{fragment:n,on_mount:o,on_destroy:a,after_update:c}=e.$$;n&&n.m(t,l),r||gt(()=>{const i=o.map(tl).filter(bl);a?a.push(...i):Be(i),e.$$.on_mount=[]}),c.forEach(gt)}function Re(e,t){const l=e.$$;l.fragment!==null&&(Be(l.on_destroy),l.fragment&&l.fragment.d(t),l.on_destroy=l.fragment=null,l.ctx=[])}function Pl(e,t){e.$$.dirty[0]===-1&&(Ze.push(e),nl(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Ct(e,t,l,r,n,o,a,c=[-1]){const i=$e;xe(e);const s=e.$$={fragment:null,ctx:null,props:o,update:Ue,not_equal:n,bound:Rt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(i?i.$$.context:[])),callbacks:Rt(),dirty:c,skip_bound:!1,root:t.target||i.$$.root};a&&a(s.root);let _=!1;if(s.ctx=l?l(e,t.props||{},(p,g,...b)=>{const d=b.length?b[0]:g;return s.ctx&&n(s.ctx[p],s.ctx[p]=d)&&(!s.skip_bound&&s.bound[p]&&s.bound[p](d),_&&Pl(e,p)),g}):[],s.update(),_=!0,Be(s.before_update),s.fragment=r?r(s.ctx):!1,t.target){if(t.hydrate){const p=wl(t.target);s.fragment&&s.fragment.l(p),p.forEach(I)}else s.fragment&&s.fragment.c();t.intro&&M(e.$$.fragment),Ie(e,t.target,t.anchor,t.customElement),rl()}xe(i)}class Dt{$destroy(){Re(this,1),this.$destroy=Ue}$on(t,l){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(l),()=>{const n=r.indexOf(l);n!==-1&&r.splice(n,1)}}$set(t){this.$$set&&!kl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Il(e){let t,l,r,n,o,a;return{c(){t=m("div"),l=H(e[1]),f(t,"style",r=e[0]&&e[2]?"background-color: "+e[2]+";":""),f(t,"class",n="h-10 p-2 "+(e[0]?e[3]:"")+" rounded-lg border-solid border-[1px] text-center svelte-mesu7o")},m(c,i){E(c,t,i),u(t,l),o||(a=[T(t,"click",e[4]),T(t,"click",e[5])],o=!0)},p(c,[i]){i&2&&ye(l,c[1]),i&5&&r!==(r=c[0]&&c[2]?"background-color: "+c[2]+";":"")&&f(t,"style",r),i&9&&n!==(n="h-10 p-2 "+(c[0]?c[3]:"")+" rounded-lg border-solid border-[1px] text-center svelte-mesu7o")&&f(t,"class",n)},i:Ue,o:Ue,d(c){c&&I(t),o=!1,Be(a)}}}function Rl(e,t,l){let{checked:r=!1}=t,{text:n="O"}=t,{bgcolor:o=""}=t,{toggleClass:a=o?"":"bg-green-600"}=t,c=()=>{console.log("toggle"),l(0,r=!r)};function i(s){ll.call(this,e,s)}return e.$$set=s=>{"checked"in s&&l(0,r=s.checked),"text"in s&&l(1,n=s.text),"bgcolor"in s&&l(2,o=s.bgcolor),"toggleClass"in s&&l(3,a=s.toggleClass)},[r,n,o,a,c,i]}class Te extends Dt{constructor(t){super(),Ct(this,t,Rl,Il,zt,{checked:0,text:1,bgcolor:2,toggleClass:3})}}function Et(e,t,l){const r=e.slice();return r[5]=t[l],r}function St(e){let t,l;return{c(){t=m("span"),l=H("\xA0"),X(t,"background-color",e[5])},m(r,n){E(r,t,n),u(t,l)},p:Ue,d(r){r&&I(t)}}}function Bl(e){let t,l,r,n,o,a,c=e[3],i=[];for(let s=0;s<c.length;s+=1)i[s]=St(Et(e,c,s));return{c(){t=m("button"),l=H(e[2]),r=v(),n=m("div");for(let s=0;s<i.length;s+=1)i[s].c();f(n,"class","svelte-63dooi"),f(t,"class","p-2 rounded-lg border-solid border-2 text-center"),A(t,"bg-green-600",e[1]==e[0])},m(s,_){E(s,t,_),u(t,l),u(t,r),u(t,n);for(let p=0;p<i.length;p+=1)i[p].m(n,null);o||(a=T(t,"click",e[4]),o=!0)},p(s,[_]){if(_&4&&ye(l,s[2]),_&8){c=s[3];let p;for(p=0;p<c.length;p+=1){const g=Et(s,c,p);i[p]?i[p].p(g,_):(i[p]=St(g),i[p].c(),i[p].m(n,null))}for(;p<i.length;p+=1)i[p].d(1);i.length=c.length}_&3&&A(t,"bg-green-600",s[1]==s[0])},i:Ue,o:Ue,d(s){s&&I(t),Ke(i,s),o=!1,a()}}}function El(e,t,l){let{color:r=""}=t,{selected:n=""}=t,{name:o="default"}=t,a=r.split(",");function c(i){ll.call(this,e,i)}return e.$$set=i=>{"color"in i&&l(0,r=i.color),"selected"in i&&l(1,n=i.selected),"name"in i&&l(2,o=i.name)},[r,n,o,a,c]}class Sl extends Dt{constructor(t){super(),Ct(this,t,El,Bl,zt,{color:0,selected:1,name:2})}}const vt=(e,t)=>({r:e.r-t.r,g:e.g-t.g,b:e.b-t.b}),Gl=(e,t)=>({r:e.r+t.r,g:e.g+t.g,b:e.b+t.b}),Ml=(e,t,l)=>Math.max(e,Math.min(t,l));let mt={};const ol=e=>{if(mt[e])return mt[e];{if(e.length==4){let[o,a,c,i]=e.split("");e="#"+a+a+c+c+i+i}let t=parseInt(e.substring(1,3),16),l=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16),n={r:t,g:l,b:r};return mt[e]=n,n}},Pt=(e,t,l)=>{let r=vt(l?al(e):e,t),n=Math.abs(r.r),o=Math.abs(r.g),a=Math.abs(r.b);return n*n+a*a+o*o};let bt={};const Nl=(e,t,l)=>{let r;bt[t]?r=bt[t]:(r=t.split(","),bt[t]=r);let n=r[0],o=null;return r.forEach((a,c)=>{let i=ol(a),s=Pt(i,e,l);(o==null||o>s)&&(o=s,n=i)}),n},Ol=(e,t,l)=>{let r=t[0],n=null;return t.forEach((o,a)=>{let c=Pt(o,e,l);(n==null||n>c)&&(n=c,r=o)}),r},sl=e=>Math.floor((e.r+e.g+e.b)/3),Tl=e=>"#"+e.r.toString(16).padStart(2,"0")+e.g.toString(16).padStart(2,"0")+e.b.toString(16).padStart(2,"0"),al=e=>{let t=sl(e);return{r:t,g:t,b:t}};function Fl(e){let t=0;for(let l=0,r=e.length;l<r;l++){let n=e.charCodeAt(l);t=(t<<5)-t+n,t|=0}return t}const It=(e,t,l)=>(t*l+e)*4;let Al=function(e,t,l,r){let n=e.width,o=It(t,l,n);e.data[o]=r.r,e.data[o+1]=r.g,e.data[o+2]=r.b},Ll=function(e,t,l){e.data[t]=l},Ul=function(e,t,l){let r=e.width,n=It(t,l,r);return{r:e.data[n],g:e.data[n+1],b:e.data[n+2]}};const P={getPixelDataRGB:Ul,setPixelDataRGB:Al,setPixelDataRaw:Ll,calc_i:It,hashCode:Fl,Rgb2Gray:al,RgbGrayValue:sl,RgbToHex:Tl,nearestPixel:Nl,nearestPixel2:Ol,clamp:Ml,pixelAdd:Gl,pixelDiff:vt,hexToRgb:ol,calculatePixelDifference:Pt};function Gt(e,t,l){const r=e.slice();return r[78]=t[l],r}function Mt(e,t,l){const r=e.slice();return r[81]=t[l],r[82]=t,r[83]=l,r}function Nt(e,t,l){const r=e.slice();return r[84]=t[l],r[85]=t,r[86]=l,r}function Ot(e,t,l){const r=e.slice();return r[87]=t[l],r}function Tt(e,t,l){const r=e.slice();return r[90]=t[l],r}function Ft(e){let t,l,r,n,o,a=!1;return{c(){t=m("div"),l=m("div"),r=m("div"),n=m("div"),f(n,"class","d-block"),f(r,"class","flex"),f(l,"class","flex flex-col"),f(t,"class","bg-white text-black p-2")},m(c,i){E(c,t,i),u(t,l),u(l,r),u(r,n),o=!0},p(c,i){},i(c){o||(M(a),o=!0)},o(c){W(a),o=!1},d(c){c&&I(t)}}}function At(e){let t,l,r,n,o,a,c,i,s,_,p,g,b,d,S=e[0].width+"",x,V,z,O,L,F,me,Y=e[0].rubiks_scale+"",de,be,_e,ve,U,B,D,y=e[0].grid_size+"",N,q,re,Z,Ge=!1;function Fe(R){e[41](R)}let Ae={text:"Show Grid"};return e[0].show_grid!==void 0&&(Ae.checked=e[0].show_grid),o=new Te({props:Ae}),pe.push(()=>Xe(o,"checked",Fe)),{c(){t=m("div"),l=m("div"),r=m("div"),n=v(),Se(o.$$.fragment),c=v(),i=m("div"),s=m("span"),s.textContent="Output Width",_=v(),p=m("input"),b=v(),d=m("span"),x=H(S),V=v(),z=m("div"),O=H(`Scale\r
            `),L=m("input"),F=v(),me=m("span"),de=H(Y),be=v(),_e=m("span"),_e.textContent="\xA0",ve=H(`\r
            Grid Size\r
            `),U=m("input"),B=v(),D=m("span"),N=H(y),f(r,"class","flex"),f(s,"class","p-2 svelte-x2icap"),X(p,"flex","1"),f(p,"type","range"),f(p,"min","3"),f(p,"max",g=e[0].max_width),f(p,"step","3"),f(p,"class","svelte-x2icap"),f(d,"class","svelte-x2icap"),f(i,"class","flex slider-wrapper svelte-x2icap"),f(L,"type","range"),f(L,"max","40"),X(_e,"margin-left","10px"),f(U,"type","range"),f(U,"max","10"),f(z,"class","flex"),X(z,"display","none"),f(l,"class","flex flex-col"),f(t,"class","bg-white text-black p-2")},m(R,oe){E(R,t,oe),u(t,l),u(l,r),u(r,n),Ie(o,r,null),u(l,c),u(l,i),u(i,s),u(i,_),u(i,p),ze(p,e[0].width),u(i,b),u(i,d),u(d,x),u(l,V),u(l,z),u(z,O),u(z,L),ze(L,e[0].rubiks_scale),u(z,F),u(z,me),u(me,de),u(z,be),u(z,_e),u(z,ve),u(z,U),ze(U,e[0].grid_size),u(z,B),u(z,D),u(D,N),q=!0,re||(Z=[T(p,"change",e[42]),T(p,"input",e[42]),T(L,"change",e[43]),T(L,"input",e[43]),T(U,"change",e[44]),T(U,"input",e[44])],re=!0)},p(R,oe){const Me={};!a&&oe[0]&1&&(a=!0,Me.checked=R[0].show_grid,Qe(()=>a=!1)),o.$set(Me),(!q||oe[0]&1&&g!==(g=R[0].max_width))&&f(p,"max",g),oe[0]&1&&ze(p,R[0].width),(!q||oe[0]&1)&&S!==(S=R[0].width+"")&&ye(x,S),oe[0]&1&&ze(L,R[0].rubiks_scale),(!q||oe[0]&1)&&Y!==(Y=R[0].rubiks_scale+"")&&ye(de,Y),oe[0]&1&&ze(U,R[0].grid_size),(!q||oe[0]&1)&&y!==(y=R[0].grid_size+"")&&ye(N,y)},i(R){q||(M(Ge),M(o.$$.fragment,R),q=!0)},o(R){W(Ge),W(o.$$.fragment,R),q=!1},d(R){R&&I(t),Re(o),re=!1,Be(Z)}}}function Lt(e){let t,l,r,n,o,a,c,i,s,_=e[0].mockup_pixel_size+"",p,g,b,d,S,x,V,z=e[0].mockup_x+"",O,L,F,me,Y,de=e[0].mockup_y+"",be,_e,ve;function U(N,q){return N[1].mockup_hovering?ql:jl}let B=U(e),D=B(e),y=e[0].has_mockup&&Ut(e);return{c(){t=m("div"),l=m("div"),D.c(),r=v(),y&&y.c(),n=v(),o=m("canvas"),a=H(`\r
\r
        Mock Up Pixel\r
        `),c=m("input"),i=v(),s=m("span"),p=H(_),g=v(),b=m("br"),d=H(`\r
        Mock Up Position\r
        `),S=m("input"),x=v(),V=m("span"),O=H(z),L=v(),F=m("input"),me=v(),Y=m("span"),be=H(de),X(o,"width","auto"),f(o,"class","svelte-x2icap"),X(l,"height","auto"),f(l,"ondragover","return false"),f(l,"id","mockup_drop_zone"),f(l,"class","bg-red-500 h-full p-4"),f(c,"type","range"),f(c,"min","1"),f(c,"max","25"),f(S,"type","range"),f(S,"min","-500"),f(S,"max","500"),f(F,"type","range"),f(F,"min","-500"),f(F,"max","500"),f(t,"class","bg-white text-black p-2")},m(N,q){E(N,t,q),u(t,l),D.m(l,null),u(l,r),y&&y.m(l,null),u(l,n),u(l,o),e[45](o),u(t,a),u(t,c),ze(c,e[0].mockup_pixel_size),u(t,i),u(t,s),u(s,p),u(t,g),u(t,b),u(t,d),u(t,S),ze(S,e[0].mockup_x),u(t,x),u(t,V),u(V,O),u(t,L),u(t,F),ze(F,e[0].mockup_y),u(t,me),u(t,Y),u(Y,be),_e||(ve=[T(l,"drop",e[23]),T(l,"dragenter",e[24]),T(l,"dragleave",e[25]),T(c,"change",e[46]),T(c,"input",e[46]),T(S,"change",e[47]),T(S,"input",e[47]),T(F,"change",e[48]),T(F,"input",e[48])],_e=!0)},p(N,q){B!==(B=U(N))&&(D.d(1),D=B(N),D&&(D.c(),D.m(l,r))),N[0].has_mockup?y?y.p(N,q):(y=Ut(N),y.c(),y.m(l,n)):y&&(y.d(1),y=null),q[0]&1&&ze(c,N[0].mockup_pixel_size),q[0]&1&&_!==(_=N[0].mockup_pixel_size+"")&&ye(p,_),q[0]&1&&ze(S,N[0].mockup_x),q[0]&1&&z!==(z=N[0].mockup_x+"")&&ye(O,z),q[0]&1&&ze(F,N[0].mockup_y),q[0]&1&&de!==(de=N[0].mockup_y+"")&&ye(be,de)},d(N){N&&I(t),D.d(),y&&y.d(),e[45](null),_e=!1,Be(ve)}}}function ql(e){let t;return{c(){t=H("Release to load file")},m(l,r){E(l,t,r)},d(l){l&&I(t)}}}function jl(e){let t;return{c(){t=H("Drop MockUp Image here")},m(l,r){E(l,t,r)},d(l){l&&I(t)}}}function Ut(e){let t,l,r;return{c(){t=m("button"),t.textContent="Remove mockup",f(t,"class","p-2 border-[1px] border-black")},m(n,o){E(n,t,o),l||(r=T(t,"click",e[26]),l=!0)},p:Ue,d(n){n&&I(t),l=!1,r()}}}function qt(e){let t,l,r,n,o,a,c,i,s,_,p,g,b,d,S;function x(z){e[51](z)}let V={text:"Live Capture"};return e[0].live_capture!==void 0&&(V.checked=e[0].live_capture),a=new Te({props:V}),pe.push(()=>Xe(a,"checked",x)),{c(){t=m("div"),l=m("button"),l.textContent="Start Capture",r=v(),n=m("button"),n.textContent="Take Screenshot",o=v(),Se(a.$$.fragment),i=v(),s=m("div"),_=m("video"),p=v(),g=m("canvas"),f(l,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),f(n,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),f(t,"class","flex"),X(_,"width","10%"),_.autoplay=!0,X(g,"width","10%"),f(g,"width",e[9]),f(g,"height",e[10]),f(g,"class","svelte-x2icap"),f(s,"class","flex")},m(z,O){E(z,t,O),u(t,l),u(t,r),u(t,n),u(t,o),Ie(a,t,null),E(z,i,O),E(z,s,O),u(s,_),e[52](_),u(s,p),u(s,g),e[53](g),b=!0,d||(S=[T(l,"click",e[49]),T(n,"click",e[50])],d=!0)},p(z,O){const L={};!c&&O[0]&1&&(c=!0,L.checked=z[0].live_capture,Qe(()=>c=!1)),a.$set(L),(!b||O[0]&512)&&f(g,"width",z[9]),(!b||O[0]&1024)&&f(g,"height",z[10])},i(z){b||(M(a.$$.fragment,z),b=!0)},o(z){W(a.$$.fragment,z),b=!1},d(z){z&&I(t),Re(a),z&&I(i),z&&I(s),e[52](null),e[53](null),d=!1,Be(S)}}}function jt(e){let t,l,r,n,o,a,c,i,s,_,p,g,b,d,S,x,V,z,O,L,F,me,Y;function de(B){e[54](B)}let be={text:"Gray Scale"};e[0].gray_scale_input!==void 0&&(be.checked=e[0].gray_scale_input),o=new Te({props:be}),pe.push(()=>Xe(o,"checked",de));function _e(B){e[55](B)}let ve={text:"Use Gray Value"};e[0].gray_scale_nearest_pixel!==void 0&&(ve.checked=e[0].gray_scale_nearest_pixel),p=new Te({props:ve}),pe.push(()=>Xe(p,"checked",_e)),V=new Te({props:{text:"None",checked:e[0].dithering==""}}),V.$on("click",e[56]),O=new Te({props:{text:"Floyd Steinberg",checked:e[0].dithering=="fs"}}),O.$on("click",e[57]),F=new Te({props:{text:"Patterned",checked:e[0].dithering=="pattern"}}),F.$on("click",e[58]);let U=e[0].dithering=="pattern"&&Wt(e);return{c(){t=m("div"),l=m("div"),r=m("span"),r.textContent="Input Image:",n=v(),Se(o.$$.fragment),c=v(),i=m("div"),s=m("span"),s.textContent="Nearest Pixel Calculation:",_=v(),Se(p.$$.fragment),b=v(),d=m("div"),S=m("span"),S.textContent="Dithering:",x=v(),Se(V.$$.fragment),z=v(),Se(O.$$.fragment),L=v(),Se(F.$$.fragment),me=v(),U&&U.c(),f(r,"class","p-2"),f(l,"class","flex"),f(s,"class","p-2"),f(i,"class","flex"),f(S,"class","p-2"),f(d,"class","flex"),f(t,"class","bg-white text-black p-2")},m(B,D){E(B,t,D),u(t,l),u(l,r),u(l,n),Ie(o,l,null),u(t,c),u(t,i),u(i,s),u(i,_),Ie(p,i,null),u(t,b),u(t,d),u(d,S),u(d,x),Ie(V,d,null),u(d,z),Ie(O,d,null),u(d,L),Ie(F,d,null),u(d,me),U&&U.m(d,null),Y=!0},p(B,D){const y={};!a&&D[0]&1&&(a=!0,y.checked=B[0].gray_scale_input,Qe(()=>a=!1)),o.$set(y);const N={};!g&&D[0]&1&&(g=!0,N.checked=B[0].gray_scale_nearest_pixel,Qe(()=>g=!1)),p.$set(N);const q={};D[0]&1&&(q.checked=B[0].dithering==""),V.$set(q);const re={};D[0]&1&&(re.checked=B[0].dithering=="fs"),O.$set(re);const Z={};D[0]&1&&(Z.checked=B[0].dithering=="pattern"),F.$set(Z),B[0].dithering=="pattern"?U?U.p(B,D):(U=Wt(B),U.c(),U.m(d,null)):U&&(U.d(1),U=null)},i(B){Y||(M(o.$$.fragment,B),M(p.$$.fragment,B),M(V.$$.fragment,B),M(O.$$.fragment,B),M(F.$$.fragment,B),Y=!0)},o(B){W(o.$$.fragment,B),W(p.$$.fragment,B),W(V.$$.fragment,B),W(O.$$.fragment,B),W(F.$$.fragment,B),Y=!1},d(B){B&&I(t),Re(o),Re(p),Re(V),Re(O),Re(F),U&&U.d()}}}function Wt(e){let t,l,r,n=e[17],o=[];for(let a=0;a<n.length;a+=1)o[a]=Ht(Tt(e,n,a));return{c(){t=m("span"),t.textContent="Matrix Size:",l=v();for(let a=0;a<o.length;a+=1)o[a].c();r=yt(),f(t,"class","h-10 p-2")},m(a,c){E(a,t,c),E(a,l,c);for(let i=0;i<o.length;i+=1)o[i].m(a,c);E(a,r,c)},p(a,c){if(c[0]&131073){n=a[17];let i;for(i=0;i<n.length;i+=1){const s=Tt(a,n,i);o[i]?o[i].p(s,c):(o[i]=Ht(s),o[i].c(),o[i].m(r.parentNode,r))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d(a){a&&I(t),a&&I(l),Ke(o,a),a&&I(r)}}}function Ht(e){let t,l=e[90].length+"",r,n,o,a;function c(){return e[59](e[90])}return{c(){t=m("button"),r=H(l),n=v(),f(t,"class","h-10 p-2 rounded-lg border-solid border-2"),A(t,"bg-green-600",e[0].matrix==e[90])},m(i,s){E(i,t,s),u(t,r),u(t,n),o||(a=T(t,"click",c),o=!0)},p(i,s){e=i,s[0]&131073&&A(t,"bg-green-600",e[0].matrix==e[90])},d(i){i&&I(t),o=!1,a()}}}function Jt(e){let t,l,r,n,o,a=e[16],c=[];for(let g=0;g<a.length;g+=1)c[g]=Vt(Ot(e,a,g));const i=g=>W(c[g],1,1,()=>{c[g]=null});let s=e[0].individual_pallette_colors,_=[];for(let g=0;g<s.length;g+=1)_[g]=Kt(Nt(e,s,g));const p=g=>W(_[g],1,1,()=>{_[g]=null});return{c(){t=m("div"),l=m("div");for(let g=0;g<c.length;g+=1)c[g].c();r=v(),n=m("div");for(let g=0;g<_.length;g+=1)_[g].c();f(l,"class","flex"),f(t,"class","bg-white text-black p-2"),f(n,"class","flex")},m(g,b){E(g,t,b),u(t,l);for(let d=0;d<c.length;d+=1)c[d].m(l,null);E(g,r,b),E(g,n,b);for(let d=0;d<_.length;d+=1)_[d].m(n,null);o=!0},p(g,b){if(b[0]&134283265){a=g[16];let d;for(d=0;d<a.length;d+=1){const S=Ot(g,a,d);c[d]?(c[d].p(S,b),M(c[d],1)):(c[d]=Vt(S),c[d].c(),M(c[d],1),c[d].m(l,null))}for(Ne(),d=a.length;d<c.length;d+=1)i(d);Oe()}if(b[0]&1){s=g[0].individual_pallette_colors;let d;for(d=0;d<s.length;d+=1){const S=Nt(g,s,d);_[d]?(_[d].p(S,b),M(_[d],1)):(_[d]=Kt(S),_[d].c(),M(_[d],1),_[d].m(n,null))}for(Ne(),d=s.length;d<_.length;d+=1)p(d);Oe()}},i(g){if(!o){for(let b=0;b<a.length;b+=1)M(c[b]);for(let b=0;b<s.length;b+=1)M(_[b]);o=!0}},o(g){c=c.filter(Boolean);for(let b=0;b<c.length;b+=1)W(c[b]);_=_.filter(Boolean);for(let b=0;b<_.length;b+=1)W(_[b]);o=!1},d(g){g&&I(t),Ke(c,g),g&&I(r),g&&I(n),Ke(_,g)}}}function Vt(e){let t,l;function r(...n){return e[60](e[87],...n)}return t=new Sl({props:{selected:e[0].pallette,name:e[87].name,color:e[87].colors}}),t.$on("click",r),{c(){Se(t.$$.fragment)},m(n,o){Ie(t,n,o),l=!0},p(n,o){e=n;const a={};o[0]&1&&(a.selected=e[0].pallette),t.$set(a)},i(n){l||(M(t.$$.fragment,n),l=!0)},o(n){W(t.$$.fragment,n),l=!1},d(n){Re(t,n)}}}function Kt(e){let t,l,r;function n(a){e[61](a,e[84])}let o={text:e[84].color,bgcolor:e[84].on?e[84].color:"white"};return e[84].on!==void 0&&(o.checked=e[84].on),t=new Te({props:o}),pe.push(()=>Xe(t,"checked",n)),{c(){Se(t.$$.fragment)},m(a,c){Ie(t,a,c),r=!0},p(a,c){e=a;const i={};c[0]&1&&(i.text=e[84].color),c[0]&1&&(i.bgcolor=e[84].on?e[84].color:"white"),!l&&c[0]&1&&(l=!0,i.checked=e[84].on,Qe(()=>l=!1)),t.$set(i)},i(a){r||(M(t.$$.fragment,a),r=!0)},o(a){W(t.$$.fragment,a),r=!1},d(a){Re(t,a)}}}function Qt(e){let t,l,r,n,o,a,c,i=e[0].dithering=="pattern"&&Xt(e),s=e[0].dithering=="fs"&&!1;return{c(){t=m("code"),l=H(e[15]),r=v(),n=v(),i&&i.c(),o=v(),s&&s.c(),a=yt()},m(_,p){E(_,t,p),u(t,l),E(_,r,p),E(_,n,p),i&&i.m(_,p),E(_,o,p),s&&s.m(_,p),E(_,a,p),c=!0},p(_,p){(!c||p[0]&32768)&&ye(l,_[15]),_[0].dithering=="pattern"?i?i.p(_,p):(i=Xt(_),i.c(),i.m(o.parentNode,o)):i&&(i.d(1),i=null),_[0].dithering=="fs",s&&(Ne(),W(s,1,1,()=>{s=null}),Oe())},i(_){c||(M(s),c=!0)},o(_){W(s),c=!1},d(_){_&&I(t),_&&I(r),_&&I(n),i&&i.d(_),_&&I(o),s&&s.d(_),_&&I(a)}}}function Xt(e){let t,l,r,n=e[0].matrix,o=[];for(let a=0;a<n.length;a+=1)o[a]=Zt(Gt(e,n,a));return{c(){t=H(`Matrix Vectors\r
        `),l=m("div");for(let a=0;a<o.length;a+=1)o[a].c();f(l,"class",r=Bt(`grid grid-cols-${e[0].matrix[0].length} w-fit`)+" svelte-x2icap")},m(a,c){E(a,t,c),E(a,l,c);for(let i=0;i<o.length;i+=1)o[i].m(l,null)},p(a,c){if(c[0]&1){n=a[0].matrix;let i;for(i=0;i<n.length;i+=1){const s=Gt(a,n,i);o[i]?o[i].p(s,c):(o[i]=Zt(s),o[i].c(),o[i].m(l,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}c[0]&1&&r!==(r=Bt(`grid grid-cols-${a[0].matrix[0].length} w-fit`)+" svelte-x2icap")&&f(l,"class",r)},d(a){a&&I(t),a&&I(l),Ke(o,a)}}}function Yt(e){let t,l,r,n=e[81]+"",o,a,c,i;function s(){e[63].call(l,e[82],e[83])}return{c(){t=m("div"),l=m("input"),r=v(),o=H(n),a=v(),f(l,"type","range"),f(l,"step","0.01"),f(l,"max","1.0"),f(l,"min","0.0"),f(t,"class","p-2 svelte-x2icap")},m(_,p){E(_,t,p),u(t,l),ze(l,e[81]),u(t,r),u(t,o),u(t,a),c||(i=[T(l,"change",s),T(l,"input",s)],c=!0)},p(_,p){e=_,p[0]&1&&ze(l,e[81]),p[0]&1&&n!==(n=e[81]+"")&&ye(o,n)},d(_){_&&I(t),c=!1,Be(i)}}}function Zt(e){let t,l=e[78],r=[];for(let n=0;n<l.length;n+=1)r[n]=Yt(Mt(e,l,n));return{c(){for(let n=0;n<r.length;n+=1)r[n].c();t=yt()},m(n,o){for(let a=0;a<r.length;a+=1)r[a].m(n,o);E(n,t,o)},p(n,o){if(o[0]&1){l=n[78];let a;for(a=0;a<l.length;a+=1){const c=Mt(n,l,a);r[a]?r[a].p(c,o):(r[a]=Yt(c),r[a].c(),r[a].m(t.parentNode,t))}for(;a<r.length;a+=1)r[a].d(1);r.length=l.length}},d(n){Ke(r,n),n&&I(t)}}}function xt(e){let t;return{c(){t=m("div"),t.textContent="Drop Image Here",X(t,"width","100%"),X(t,"height","100%"),X(t,"border","1px solid black"),X(t,"background","#ccc"),X(t,"text-align","center")},m(l,r){E(l,t,r)},d(l){l&&I(t)}}}function Wl(e){let t,l,r;return{c(){t=m("canvas"),f(t,"id","rubiks_canvas"),f(t,"width",l=e[1].resizedwidth*e[0].rubiks_scale),f(t,"height",r=e[1].resizedheight*e[0].rubiks_scale),f(t,"class","svelte-x2icap"),A(t,"shown",e[3]&&e[0].show_rubiks),A(t,"pixelated",e[0].pixelated)},m(n,o){E(n,t,o),e[70](t)},p(n,o){o[0]&3&&l!==(l=n[1].resizedwidth*n[0].rubiks_scale)&&f(t,"width",l),o[0]&3&&r!==(r=n[1].resizedheight*n[0].rubiks_scale)&&f(t,"height",r),o[0]&9&&A(t,"shown",n[3]&&n[0].show_rubiks),o[0]&1&&A(t,"pixelated",n[0].pixelated)},d(n){n&&I(t),e[70](null)}}}function Hl(e){let t,l,r;return{c(){t=m("canvas"),X(t,"position","absolute"),X(t,"top",e[4]/2-e[1].resizedheight*e[0].mockup_pixel_size*e[2]/e[1].mockupwidth/2+e[0].mockup_y*e[2]/e[1].mockupwidth+"px"),X(t,"left",e[2]/2-e[1].resizedwidth*e[0].mockup_pixel_size*e[2]/e[1].mockupwidth/2+e[0].mockup_x*e[2]/e[1].mockupwidth+"px"),X(t,"width",e[1].resizedwidth*e[0].mockup_pixel_size*e[2]/e[1].mockupwidth+"px"),f(t,"id","rubiks_canvas"),f(t,"width",l=e[1].resizedwidth*e[0].rubiks_scale),f(t,"height",r=e[1].resizedheight*e[0].rubiks_scale),f(t,"class","svelte-x2icap"),A(t,"shown",e[3]&&e[0].show_rubiks),A(t,"pixelated",e[0].pixelated)},m(n,o){E(n,t,o),e[69](t)},p(n,o){o[0]&23&&X(t,"top",n[4]/2-n[1].resizedheight*n[0].mockup_pixel_size*n[2]/n[1].mockupwidth/2+n[0].mockup_y*n[2]/n[1].mockupwidth+"px"),o[0]&7&&X(t,"left",n[2]/2-n[1].resizedwidth*n[0].mockup_pixel_size*n[2]/n[1].mockupwidth/2+n[0].mockup_x*n[2]/n[1].mockupwidth+"px"),o[0]&7&&X(t,"width",n[1].resizedwidth*n[0].mockup_pixel_size*n[2]/n[1].mockupwidth+"px"),o[0]&3&&l!==(l=n[1].resizedwidth*n[0].rubiks_scale)&&f(t,"width",l),o[0]&3&&r!==(r=n[1].resizedheight*n[0].rubiks_scale)&&f(t,"height",r),o[0]&9&&A(t,"shown",n[3]&&n[0].show_rubiks),o[0]&1&&A(t,"pixelated",n[0].pixelated)},d(n){n&&I(t),e[69](null)}}}function $t(e){let t;return{c(){t=m("div"),t.textContent="Drop to load image",f(t,"class","rounded-lg border-solid border-2 p-8 text-white text-center m-auto w-fit")},m(l,r){E(l,t,r)},d(l){l&&I(t)}}}function el(e){let t,l=e[1].resizedwidth+"",r,n,o=e[1].resizedheight+"",a,c,i=e[1].resizedwidth*e[1].resizedheight+"",s,_,p=e[1].resizedheight*e[1].resizedwidth/9+"",g;return{c(){t=H("Image Size: "),r=H(l),n=H(" x "),a=H(o),c=H(" = "),s=H(i),_=H(`\r
      | Total Cubes Needed: `),g=H(p)},m(b,d){E(b,t,d),E(b,r,d),E(b,n,d),E(b,a,d),E(b,c,d),E(b,s,d),E(b,_,d),E(b,g,d)},p(b,d){d[0]&2&&l!==(l=b[1].resizedwidth+"")&&ye(r,l),d[0]&2&&o!==(o=b[1].resizedheight+"")&&ye(a,o),d[0]&2&&i!==(i=b[1].resizedwidth*b[1].resizedheight+"")&&ye(s,i),d[0]&2&&p!==(p=b[1].resizedheight*b[1].resizedwidth/9+"")&&ye(g,p)},d(b){b&&I(t),b&&I(r),b&&I(n),b&&I(a),b&&I(c),b&&I(s),b&&I(_),b&&I(g)}}}function Jl(e){let t,l,r,n,o,a,c,i,s,_,p,g,b,d,S,x,V,z,O,L,F,me,Y,de,be,_e,ve,U,B,D,y,N,q,re,Z,Ge,Fe,Ae,R,oe,Me,et,Ee,se,je,We,tt,lt,it,nt,Q,Ye,rt;function ht(k){e[37](k)}let ot={text:"debug"};e[1].show_debug!==void 0&&(ot.checked=e[1].show_debug),L=new Te({props:ot}),pe.push(()=>Xe(L,"checked",ht));let $=e[1].current=="img"&&Ft(),ee=e[1].current=="rubiks"&&At(e),ge=e[1].current=="mockup"&&Lt(e),te=(e[1].current=="screen_capture"||e[0].live_capture)&&qt(e),le=e[1].current=="processing"&&jt(e),ie=e[1].current=="pallette"&&Jt(e),ne=e[1].show_debug&&Qt(e),ke=!e[3]&&xt();function st(k,G){return k[0].has_mockup?Hl:Wl}let He=st(e),Ce=He(e),we=!e[3]&&e[1].hovering&&$t(),he=e[1].resizedheight&&e[1].resizedwidth&&el(e);return{c(){t=m("main"),l=m("div"),r=m("div"),n=m("div"),o=v(),a=m("button"),a.textContent="Pallette",c=v(),i=m("button"),i.textContent="Processing",s=v(),_=m("button"),_.textContent="Rubiks",p=v(),g=m("button"),g.textContent="Mock\xA0Up",b=v(),d=m("button"),d.textContent="Screen\xA0Capture",S=v(),x=m("button"),x.textContent="Capture",V=v(),z=m("div"),O=v(),Se(L.$$.fragment),me=v(),$&&$.c(),Y=v(),ee&&ee.c(),de=v(),ge&&ge.c(),be=v(),te&&te.c(),_e=v(),le&&le.c(),ve=v(),ie&&ie.c(),U=v(),ne&&ne.c(),B=v(),D=m("div"),y=m("div"),ke&&ke.c(),N=v(),q=m("div"),re=m("div"),Z=m("canvas"),Ae=v(),R=m("canvas"),et=v(),Ee=m("div"),se=m("canvas"),lt=v(),Ce.c(),it=v(),we&&we.c(),nt=v(),he&&he.c(),f(a,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),A(a,"bg-gray-400",e[1].current=="pallette"),f(i,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),A(i,"bg-gray-400",e[1].current=="processing"),f(_,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),A(_,"bg-gray-400",e[1].current=="rubiks"),f(g,"class","hidden h-10 p-2 rounded-lg border-solid border-2 text-center"),A(g,"bg-gray-400",e[1].current=="mockup"),f(d,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),A(d,"bg-gray-400",e[1].current=="screen_capture"||e[0].live_capture),f(x,"class","hidden h-10 p-2 rounded-lg border-solid border-2 text-center"),f(z,"class","spacer svelte-x2icap"),f(n,"class","flex"),f(r,"class","bg-white text-black p-2"),f(Z,"class","small svelte-x2icap"),f(Z,"id","canvas"),f(Z,"width",Ge=e[1].canvaswidth),f(Z,"height",Fe=e[1].canvasheight),A(Z,"shown",e[3]),A(Z,"pixelated",e[0].pixelated),f(R,"id","output_canvas"),f(R,"width",oe=e[1].resizedwidth),f(R,"height",Me=e[1].resizedheight),X(R,"border","4px solid red"),f(R,"class","svelte-x2icap"),A(R,"small",e[0].show_rubiks),A(R,"shown",e[3]),A(R,"pixelated",e[0].pixelated),X(se,"position","absolute"),f(se,"id","bgcanvas"),f(se,"width",je=e[1].mockupwidth),f(se,"height",We=e[1].mockupheight),f(se,"class","svelte-x2icap"),gt(()=>e[68].call(se)),A(se,"shown",e[0].has_mockup),X(Ee,"position","relative"),f(Ee,"id","canvas_wrapper"),f(re,"class","flex-col"),f(q,"class","flex"),f(y,"ondragover","return false"),f(y,"id","drop_zone"),f(y,"class","bg-white h-full"),f(D,"class","bg-green-800 grow justify-center"),f(l,"class","flex flex-col h-screen")},m(k,G){E(k,t,G),u(t,l),u(l,r),u(r,n),u(n,o),u(n,a),u(n,c),u(n,i),u(n,s),u(n,_),u(n,p),u(n,g),u(n,b),u(n,d),u(n,S),u(n,x),u(n,V),u(n,z),u(n,O),Ie(L,n,null),u(l,me),$&&$.m(l,null),u(l,Y),ee&&ee.m(l,null),u(l,de),ge&&ge.m(l,null),u(l,be),te&&te.m(l,null),u(l,_e),le&&le.m(l,null),u(l,ve),ie&&ie.m(l,null),u(l,U),ne&&ne.m(l,null),u(l,B),u(l,D),u(D,y),ke&&ke.m(y,null),u(y,N),u(y,q),u(q,re),u(re,Z),e[65](Z),u(re,Ae),u(re,R),e[66](R),u(re,et),u(re,Ee),u(Ee,se),e[67](se),tt=zl(se,e[68].bind(se)),u(Ee,lt),Ce.m(Ee,null),u(y,it),we&&we.m(y,null),u(l,nt),he&&he.m(l,null),Q=!0,Ye||(rt=[T(a,"click",e[31]),T(i,"click",e[32]),T(_,"click",e[33]),T(g,"click",e[34]),T(d,"click",e[35]),T(x,"click",e[36]),T(y,"drop",e[20]),T(y,"dragenter",e[21]),T(y,"dragleave",e[22])],Ye=!0)},p(k,G){(!Q||G[0]&2)&&A(a,"bg-gray-400",k[1].current=="pallette"),(!Q||G[0]&2)&&A(i,"bg-gray-400",k[1].current=="processing"),(!Q||G[0]&2)&&A(_,"bg-gray-400",k[1].current=="rubiks"),(!Q||G[0]&2)&&A(g,"bg-gray-400",k[1].current=="mockup"),(!Q||G[0]&3)&&A(d,"bg-gray-400",k[1].current=="screen_capture"||k[0].live_capture);const at={};!F&&G[0]&2&&(F=!0,at.checked=k[1].show_debug,Qe(()=>F=!1)),L.$set(at),k[1].current=="img"?$?($.p(k,G),G[0]&2&&M($,1)):($=Ft(),$.c(),M($,1),$.m(l,Y)):$&&(Ne(),W($,1,1,()=>{$=null}),Oe()),k[1].current=="rubiks"?ee?(ee.p(k,G),G[0]&2&&M(ee,1)):(ee=At(k),ee.c(),M(ee,1),ee.m(l,de)):ee&&(Ne(),W(ee,1,1,()=>{ee=null}),Oe()),k[1].current=="mockup"?ge?ge.p(k,G):(ge=Lt(k),ge.c(),ge.m(l,be)):ge&&(ge.d(1),ge=null),k[1].current=="screen_capture"||k[0].live_capture?te?(te.p(k,G),G[0]&3&&M(te,1)):(te=qt(k),te.c(),M(te,1),te.m(l,_e)):te&&(Ne(),W(te,1,1,()=>{te=null}),Oe()),k[1].current=="processing"?le?(le.p(k,G),G[0]&2&&M(le,1)):(le=jt(k),le.c(),M(le,1),le.m(l,ve)):le&&(Ne(),W(le,1,1,()=>{le=null}),Oe()),k[1].current=="pallette"?ie?(ie.p(k,G),G[0]&2&&M(ie,1)):(ie=Jt(k),ie.c(),M(ie,1),ie.m(l,U)):ie&&(Ne(),W(ie,1,1,()=>{ie=null}),Oe()),k[1].show_debug?ne?(ne.p(k,G),G[0]&2&&M(ne,1)):(ne=Qt(k),ne.c(),M(ne,1),ne.m(l,B)):ne&&(Ne(),W(ne,1,1,()=>{ne=null}),Oe()),k[3]?ke&&(ke.d(1),ke=null):ke||(ke=xt(),ke.c(),ke.m(y,N)),(!Q||G[0]&2&&Ge!==(Ge=k[1].canvaswidth))&&f(Z,"width",Ge),(!Q||G[0]&2&&Fe!==(Fe=k[1].canvasheight))&&f(Z,"height",Fe),(!Q||G[0]&8)&&A(Z,"shown",k[3]),(!Q||G[0]&1)&&A(Z,"pixelated",k[0].pixelated),(!Q||G[0]&2&&oe!==(oe=k[1].resizedwidth))&&f(R,"width",oe),(!Q||G[0]&2&&Me!==(Me=k[1].resizedheight))&&f(R,"height",Me),(!Q||G[0]&1)&&A(R,"small",k[0].show_rubiks),(!Q||G[0]&8)&&A(R,"shown",k[3]),(!Q||G[0]&1)&&A(R,"pixelated",k[0].pixelated),(!Q||G[0]&2&&je!==(je=k[1].mockupwidth))&&f(se,"width",je),(!Q||G[0]&2&&We!==(We=k[1].mockupheight))&&f(se,"height",We),(!Q||G[0]&1)&&A(se,"shown",k[0].has_mockup),He===(He=st(k))&&Ce?Ce.p(k,G):(Ce.d(1),Ce=He(k),Ce&&(Ce.c(),Ce.m(Ee,null))),!k[3]&&k[1].hovering?we||(we=$t(),we.c(),we.m(y,null)):we&&(we.d(1),we=null),k[1].resizedheight&&k[1].resizedwidth?he?he.p(k,G):(he=el(k),he.c(),he.m(l,null)):he&&(he.d(1),he=null)},i(k){Q||(M(L.$$.fragment,k),M($),M(ee),M(te),M(le),M(ie),M(ne),Q=!0)},o(k){W(L.$$.fragment,k),W($),W(ee),W(te),W(le),W(ie),W(ne),Q=!1},d(k){k&&I(t),Re(L),$&&$.d(),ee&&ee.d(),ge&&ge.d(),te&&te.d(),le&&le.d(),ie&&ie.d(),ne&&ne.d(),ke&&ke.d(),e[65](null),e[66](null),e[67](null),tt(),Ce.d(),we&&we.d(),he&&he.d(),Ye=!1,Be(rt)}}}function Vl(e,t,l){let r,n,o=!1,a=[{name:"rbk",colors:"#013082,#BB2328,#01B351,#FE8F25,#F5FF42,#ECF3F6"},{name:"rbkng",colors:"#013082,#BB2328,#FE8F25,#F5FF42,#ECF3F6"},{name:"b&w",colors:"#000,#fff"},{name:"gray",colors:"#000,#666,#fff"},{name:"grayscale",colors:"#000,#111,#222,#333,#444,#555,#666,#777,#888,#999,#aaa,#bbb,#ccc,#ddd,#eee,#fff"},{name:"rgb",colors:"#000,#f00,#0f0,#00f,#fff"},{name:"cmyk",colors:"#000,#0ff,#f0f,#ff0,#fff"}],c=[[[0/4,2/4],[3/4,1/4]],[[0/16,8/16,2/16,10/16],[12/16,4/16,14/16,6/16],[3/16,11/16,1/16,9/16],[15/16,7/16,13/16,5/16]]],i={loadedfile:"",cache:!0,cap:!1,pixelated:!1,has_mockup:!1,mockup_pixel_size:1,mockup_x:0,mockup_y:0,width:0,height:0,dithering:"fs",max_width:600,show_rubiks:!0,show_grid:!0,rubiks_scale:8,gray_scale_input:!1,gray_scale_nearest_pixel:!1,grid_size:2,pallette:a[0].colors,individual_pallette_colors:[],debug_range:-1,matrix:c[0],live_capture:!1},s={current:"",hovering:!1,mockup_hovering:!1,mockupheight:100,mockupwidth:100,show_debug:!1,resizedwidth:0,resizedheight:0,total_pixels:0,canvaswidth:100,canvasheight:100},_,p,g,b,d,S,x,V,z,O="",L={},F;async function me(h){let C=null;try{C=await navigator.mediaDevices.getDisplayMedia(h),l(12,F.srcObject=C,F)}catch(ae){console.error(`Error: ${ae}`)}let w=()=>{q&&(i.live_capture&&q(),setTimeout(w,1e3/15))};w()}let Y=async function(){if(S){let h=S.getContext("2d");await Ve();let C=300,w=C*F.videoHeight/F.videoWidth;l(9,x=C),l(10,V=w),h.drawImage(F,0,0,C,w),Fe(S)}},de=function(h){h.preventDefault();let C=h;if(C.dataTransfer.items)if(C.dataTransfer.items.length==1){let w=C.dataTransfer.items[0];if(w.kind==="file"){const ae=w.getAsFile();Ge(ae)}else console.log("kind is not file, but: "+w.kind)}else l(15,n="Error: can only load one file");l(1,s.hovering=!1,s)},be=function(){console.log("drag enter"),l(1,s.hovering=!0,s)},_e=function(){l(1,s.hovering=!1,s)},ve=function(h){h.preventDefault();let C=h;if(C.dataTransfer.items)if(C.dataTransfer.items.length==1){let w=C.dataTransfer.items[0];if(w.kind==="file"){const ae=w.getAsFile();l(0,i.has_mockup=!0,i),re(ae)}else console.log("kind is not file, but: "+w.kind)}else l(15,n="Error: can only load one file");l(1,s.mockup_hovering=!1,s)},U=function(){console.log("drag enter"),l(1,s.mockup_hovering=!0,s)},B=function(){l(1,s.mockup_hovering=!1,s)},D,y,N,q=null,re=function(h){let C=b.getContext("2d"),w=N.getContext("2d");y=new Image,y.onload=async function(){await Ve(),l(1,s.mockupheight=y.height,s),l(1,s.mockupwidth=y.width,s),await Ve(),C.drawImage(y,0,0,y.width,y.height),w.drawImage(y,0,0,200,200*y.height/y.width)},y.src=URL.createObjectURL(h)},Z=function(){l(0,i.has_mockup=!1,i),y.src=null,N.getContext("2d").clearRect(0,0,N.width,N.height)},Ge=function(h){l(0,i.loadedfile=h.name,i);let C=g.getContext("2d");D=new Image,D.onload=async function(){l(1,s.canvasheight=D.height,s),l(1,s.canvaswidth=D.width,s),l(0,i.width=Math.min(99,s.canvaswidth),i),l(0,i.max_width=Math.min(s.canvaswidth,999),i),l(3,o=!0),L={},await Ve(),C.drawImage(D,0,0,D.width,D.height)},D.src=URL.createObjectURL(h)},Fe=function(h){let C=g.getContext("2d");D=new Image,D.onload=async function(){l(1,s.canvasheight=D.height,s),l(1,s.canvaswidth=D.width,s),l(3,o=!0),L={},await Ve(),C.drawImage(D,0,0,D.width,D.height)},D.src=h.toDataURL("image/png")},Ae=function(h){l(0,i.pallette=h,i),l(0,i.individual_pallette_colors=[],i),h.split(",").forEach(C=>{i.individual_pallette_colors.push({color:C,on:!0})})},R=function(h){s.current==h?l(1,s.current="",s):l(1,s.current=h,s)};Cl(async()=>{if(!i.width){console.log("no width, ending here");return}if(!o){console.log("no image loaded, ending here");return}if(!D){console.log("originalImage is empty","ending here");return}let h=s.canvasheight/s.canvaswidth*i.width;if(l(0,i.height=h,i),l(1,s.resizedwidth=parseInt(i.width/3)*3,s),l(1,s.resizedheight=parseInt(h/3)*3,s),l(1,s.total_pixels=s.resizedheight*s.resizedwidth,s),await Ve(),h<1){console.log("height is less than 1","ending here");return}if(O=P.hashCode(JSON.stringify(r)),i.cache&&O&&L[O]){console.log("found",r.loadedfile,O,"from cache");let C=d.getContext("2d"),w=L[O].data,ae=new ImageData(w.data,w.width,w.height);C.putImageData(ae,0,0)}else{console.log("GENERATING IMAGE",JSON.stringify(r),O);let C=d.getContext("2d");C.drawImage(D,0,0,s.resizedwidth,s.resizedheight);let w=C.getImageData(0,0,s.resizedwidth,s.resizedheight);if(i.gray_scale_input)for(let j=0,ce=0;j<w.height;j++)for(let K=0;K<w.width;K++,ce+=4){let Je=P.getPixelDataRGB(w,K,j),Pe=Math.round((Je.r+Je.g+Je.b)/3);P.setPixelDataRaw(w,ce,Pe),P.setPixelDataRaw(w,ce+1,Pe),P.setPixelDataRaw(w,ce+2,Pe)}let ae=i.pallette;i.individual_pallette_colors.length&&(ae=i.individual_pallette_colors.filter(j=>j.on).map(j=>j.color).join(","));let De=ae.split(",").length,ct=ae.split(",");ct.forEach((j,ce)=>{ct[ce]=P.hexToRgb(j)});for(let j=0,ce=0;j<w.height;j++)for(let K=0;K<w.width;K++,ce+=4){let Je=P.getPixelDataRGB(w,K,j),Pe=P.nearestPixel2(Je,ct,i.gray_scale_nearest_pixel);if(i.dithering=="")P.setPixelDataRaw(w,ce,Pe.r),P.setPixelDataRaw(w,ce+1,Pe.g),P.setPixelDataRaw(w,ce+2,Pe.b);else if(i.dithering=="fs"){P.setPixelDataRaw(w,ce,Pe.r),P.setPixelDataRaw(w,ce+1,Pe.g),P.setPixelDataRaw(w,ce+2,Pe.b);let J=P.pixelDiff(Je,Pe);if(K<w.width-1){let ue=P.getPixelDataRGB(w,K+1,j);i.cap?P.setPixelDataRGB(w,K+1,j,{r:P.clamp(0,255,ue.r+J.r*7/16),g:P.clamp(0,255,ue.g+J.g*7/16),b:P.clamp(0,255,ue.b+J.b*7/16)}):P.setPixelDataRGB(w,K+1,j,{r:ue.r+J.r*7/16,g:ue.g+J.g*7/16,b:ue.b+J.b*7/16})}if(j<w.height-1){if(K>0){let fe=P.getPixelDataRGB(w,K-1,j+1);i.cap?P.setPixelDataRGB(w,K-1,j+1,{r:P.clamp(0,255,fe.r+J.r*3/16),g:P.clamp(0,255,fe.g+J.g*3/16),b:P.clamp(0,255,fe.b+J.b*3/16)}):P.setPixelDataRGB(w,K-1,j+1,{r:fe.r+J.r*3/16,g:fe.g+J.g*3/16,b:fe.b+J.b*3/16})}let ue=P.getPixelDataRGB(w,K,j+1);if(i.cap?P.setPixelDataRGB(w,K,j+1,{r:P.clamp(0,255,ue.r+J.r*5/16),g:P.clamp(0,255,ue.g+J.g*5/16),b:P.clamp(0,255,ue.b+J.b*5/16)}):P.setPixelDataRGB(w,K,j+1,{r:ue.r+J.r*5/16,g:ue.g+J.g*5/16,b:ue.b+J.b*5/16}),K<w.width-1){let fe=P.getPixelDataRGB(w,K+1,j+1);i.cap?P.setPixelDataRGB(w,K+1,j+1,{r:P.clamp(0,255,fe.r+J.r*1/16),g:P.clamp(0,255,fe.g+J.g*1/16),b:P.clamp(0,255,fe.b+J.b*1/16)}):P.setPixelDataRGB(w,K+1,j+1,{r:fe.r+J.r*1/16,g:fe.g+J.g*1/16,b:fe.b+J.b*1/16})}}}else if(i.dithering=="pattern"){let J=P.getPixelDataRGB(w,K,j),ue=255/De*(i.matrix[K%i.matrix[0].length][j%i.matrix.length]-.5),fe=P.nearestPixel2({r:J.r+ue,g:J.g+ue,b:J.b+ue},ct,i.gray_scale_nearest_pixel);P.setPixelDataRaw(w,ce,fe.r),P.setPixelDataRaw(w,ce+1,fe.g),P.setPixelDataRaw(w,ce+2,fe.b)}}if(C.putImageData(w,0,0),i.cache){let j=new ImageData(new Uint8ClampedArray(w.data),w.width,w.height);console.log("adding",O,"to cache"),L[O]={data:j,params:Object.assign({},r),config:Object.assign({},i)}}}if(i.show_rubiks){let C=z.getContext("2d"),ae=d.getContext("2d").getImageData(0,0,s.resizedwidth,s.resizedheight);if(C.imageSmoothingEnabled=!1,C.drawImage(d,0,0,s.resizedwidth*i.rubiks_scale,s.resizedheight*i.rubiks_scale),i.show_grid&&i.grid_size>0){C.lineWidth=i.grid_size,C.strokeStyle="#000000";for(let De=0;De<ae.height;De++)C.beginPath(),C.moveTo(0,De*i.rubiks_scale),C.lineTo(ae.width*i.rubiks_scale,De*i.rubiks_scale),C.stroke();for(let De=0;De<ae.width;De++)C.beginPath(),C.moveTo(De*i.rubiks_scale,0),C.lineTo(De*i.rubiks_scale,ae.height*i.rubiks_scale),C.stroke()}}});const oe=()=>{R("img")},Me=()=>{R("pallette")},et=()=>{R("processing")},Ee=()=>{R("rubiks")},se=()=>{R("mockup")},je=()=>{R("screen_capture")},We=()=>{Y()};function tt(h){e.$$.not_equal(s.show_debug,h)&&(s.show_debug=h,l(1,s))}function lt(h){e.$$.not_equal(i.pixelated,h)&&(i.pixelated=h,l(0,i))}function it(h){e.$$.not_equal(i.cache,h)&&(i.cache=h,l(0,i))}function nt(h){e.$$.not_equal(i.show_rubiks,h)&&(i.show_rubiks=h,l(0,i))}function Q(h){e.$$.not_equal(i.show_grid,h)&&(i.show_grid=h,l(0,i))}function Ye(){i.width=Le(this.value),l(0,i)}function rt(){i.rubiks_scale=Le(this.value),l(0,i)}function ht(){i.grid_size=Le(this.value),l(0,i)}function ot(h){pe[h?"unshift":"push"](()=>{N=h,l(13,N)})}function $(){i.mockup_pixel_size=Le(this.value),l(0,i)}function ee(){i.mockup_x=Le(this.value),l(0,i)}function ge(){i.mockup_y=Le(this.value),l(0,i)}const te=()=>{l(14,q=Y),me()},le=()=>{Y()};function ie(h){e.$$.not_equal(i.live_capture,h)&&(i.live_capture=h,l(0,i))}function ne(h){pe[h?"unshift":"push"](()=>{F=h,l(12,F)})}function ke(h){pe[h?"unshift":"push"](()=>{S=h,l(8,S)})}function st(h){e.$$.not_equal(i.gray_scale_input,h)&&(i.gray_scale_input=h,l(0,i))}function He(h){e.$$.not_equal(i.gray_scale_nearest_pixel,h)&&(i.gray_scale_nearest_pixel=h,l(0,i))}const Ce=()=>l(0,i.dithering="",i),we=()=>l(0,i.dithering="fs",i),he=()=>l(0,i.dithering="pattern",i),k=h=>{l(0,i.matrix=h,i)},G=(h,C,w)=>{Ae(h.colors)};function at(h,C){e.$$.not_equal(C.on,h)&&(C.on=h,l(0,i))}function cl(){i.debug_range=Le(this.value),l(0,i)}function ul(h,C){h[C]=Le(this.value),l(0,i)}function fl(h){e.$$.not_equal(i.cap,h)&&(i.cap=h,l(0,i))}function dl(h){pe[h?"unshift":"push"](()=>{g=h,l(5,g)})}function _l(h){pe[h?"unshift":"push"](()=>{d=h,l(7,d)})}function gl(h){pe[h?"unshift":"push"](()=>{b=h,l(6,b)})}function hl(){p=this.clientHeight,_=this.clientWidth,l(4,p),l(2,_)}function pl(h){pe[h?"unshift":"push"](()=>{z=h,l(11,z)})}function ml(h){pe[h?"unshift":"push"](()=>{z=h,l(11,z)})}return e.$$.update=()=>{e.$$.dirty[0]&1&&l(29,r={loadedfile:i.loadedfile,width:i.width,height:i.height,dithering:i.dithering,gray_scale_input:i.gray_scale_input,gray_scale_nearest_pixel:i.gray_scale_nearest_pixel,pallette:i.pallette,individual_pallette_colors:i.individual_pallette_colors,matrix:i.matrix}),e.$$.dirty[0]&536870919&&l(15,n=("UI = "+JSON.stringify(s)+`
params: `+JSON.stringify(r)+`
CONFIG:`+JSON.stringify(i)+"CLIENT WIDTH:"+_).replaceAll(",",", "))},[i,s,_,o,p,g,b,d,S,x,V,z,F,N,q,n,a,c,me,Y,de,be,_e,ve,U,B,Z,Ae,R,r,oe,Me,et,Ee,se,je,We,tt,lt,it,nt,Q,Ye,rt,ht,ot,$,ee,ge,te,le,ie,ne,ke,st,He,Ce,we,he,k,G,at,cl,ul,fl,dl,_l,gl,hl,pl,ml]}class Kl extends Dt{constructor(t){super(),Ct(this,t,Vl,Jl,zt,{},null,[-1,-1,-1])}}new Kl({target:document.getElementById("app")});
