(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function l(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=l(o);fetch(o.href,a)}})();function Se(){}function jt(e){return e()}function bt(){return Object.create(null)}function ze(e){e.forEach(jt)}function Yt(e){return typeof e=="function"}function gt(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Zt(e){return Object.keys(e).length===0}function g(e,t){e.appendChild(t)}function E(e,t,l){e.insertBefore(t,l||null)}function I(e){e.parentNode.removeChild(e)}function Ue(e,t){for(let l=0;l<e.length;l+=1)e[l]&&e[l].d(t)}function v(e){return document.createElement(e)}function M(e){return document.createTextNode(e)}function P(){return M(" ")}function dt(){return M("")}function T(e,t,l,i){return e.addEventListener(t,l,i),()=>e.removeEventListener(t,l,i)}function d(e,t,l){l==null?e.removeAttribute(t):e.getAttribute(t)!==l&&e.setAttribute(t,l)}function Ee(e){return e===""?null:+e}function $t(e){return Array.from(e.childNodes)}function ue(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function ge(e,t){e.value=t==null?"":t}function be(e,t,l,i){l===null?e.style.removeProperty(t):e.style.setProperty(t,l,i?"important":"")}let xe;function xt(){if(xe===void 0){xe=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{xe=!0}}return xe}function el(e,t){getComputedStyle(e).position==="static"&&(e.style.position="relative");const i=v("iframe");i.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),i.setAttribute("aria-hidden","true"),i.tabIndex=-1;const o=xt();let a;return o?(i.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",a=T(window,"message",s=>{s.source===i.contentWindow&&t()})):(i.src="about:blank",i.onload=()=>{a=T(i.contentWindow,"resize",t)}),g(e,i),()=>{(o||a&&i.contentWindow)&&a(),I(i)}}function U(e,t,l){e.classList[l?"add":"remove"](t)}let He;function We(e){He=e}function tl(){if(!He)throw new Error("Function called outside component initialization");return He}function ll(e){tl().$$.after_update.push(e)}function Wt(e,t){const l=e.$$.callbacks[t.type];l&&l.slice().forEach(i=>i.call(this,t))}const je=[],he=[],lt=[],ft=[],Ht=Promise.resolve();let ct=!1;function Jt(){ct||(ct=!0,Ht.then(Kt))}function et(){return Jt(),Ht}function it(e){lt.push(e)}function Ie(e){ft.push(e)}const rt=new Set;let tt=0;function Kt(){const e=He;do{for(;tt<je.length;){const t=je[tt];tt++,We(t),nl(t.$$)}for(We(null),je.length=0,tt=0;he.length;)he.pop()();for(let t=0;t<lt.length;t+=1){const l=lt[t];rt.has(l)||(rt.add(l),l())}lt.length=0}while(je.length);for(;ft.length;)ft.pop()();ct=!1,rt.clear(),We(e)}function nl(e){if(e.fragment!==null){e.update(),ze(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(it)}}const nt=new Set;let Ne;function Be(){Ne={r:0,c:[],p:Ne}}function Ge(){Ne.r||ze(Ne.c),Ne=Ne.p}function B(e,t){e&&e.i&&(nt.delete(e),e.i(t))}function q(e,t,l,i){if(e&&e.o){if(nt.has(e))return;nt.add(e),Ne.c.push(()=>{nt.delete(e),i&&(l&&e.d(1),i())}),e.o(t)}else i&&i()}function Ce(e,t,l){const i=e.$$.props[t];i!==void 0&&(e.$$.bound[i]=l,l(e.$$.ctx[i]))}function ke(e){e&&e.c()}function pe(e,t,l,i){const{fragment:o,on_mount:a,on_destroy:s,after_update:c}=e.$$;o&&o.m(t,l),i||it(()=>{const n=a.map(jt).filter(Yt);s?s.push(...n):ze(n),e.$$.on_mount=[]}),c.forEach(it)}function me(e,t){const l=e.$$;l.fragment!==null&&(ze(l.on_destroy),l.fragment&&l.fragment.d(t),l.on_destroy=l.fragment=null,l.ctx=[])}function il(e,t){e.$$.dirty[0]===-1&&(je.push(e),Jt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ht(e,t,l,i,o,a,s,c=[-1]){const n=He;We(e);const r=e.$$={fragment:null,ctx:null,props:a,update:Se,not_equal:o,bound:bt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(n?n.$$.context:[])),callbacks:bt(),dirty:c,skip_bound:!1,root:t.target||n.$$.root};s&&s(r.root);let b=!1;if(r.ctx=l?l(e,t.props||{},(k,h,...p)=>{const u=p.length?p[0]:h;return r.ctx&&o(r.ctx[k],r.ctx[k]=u)&&(!r.skip_bound&&r.bound[k]&&r.bound[k](u),b&&il(e,k)),h}):[],r.update(),b=!0,ze(r.before_update),r.fragment=i?i(r.ctx):!1,t.target){if(t.hydrate){const k=$t(t.target);r.fragment&&r.fragment.l(k),k.forEach(I)}else r.fragment&&r.fragment.c();t.intro&&B(e.$$.fragment),pe(e,t.target,t.anchor,t.customElement),Kt()}We(n)}class _t{$destroy(){me(this,1),this.$destroy=Se}$on(t,l){const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(l),()=>{const o=i.indexOf(l);o!==-1&&i.splice(o,1)}}$set(t){this.$$set&&!Zt(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function ol(e){let t,l,i,o,a,s;return{c(){t=v("div"),l=M(e[1]),d(t,"style",i=e[0]&&e[2]?"background-color: "+e[2]+";":""),d(t,"class",o="h-10 p-2 "+(e[0]?e[3]:"")+" rounded-lg "+(e[0]?"border-solid":"border-none")+" border-2 text-center svelte-mesu7o")},m(c,n){E(c,t,n),g(t,l),a||(s=[T(t,"click",e[4]),T(t,"click",e[5])],a=!0)},p(c,[n]){n&2&&ue(l,c[1]),n&5&&i!==(i=c[0]&&c[2]?"background-color: "+c[2]+";":"")&&d(t,"style",i),n&9&&o!==(o="h-10 p-2 "+(c[0]?c[3]:"")+" rounded-lg "+(c[0]?"border-solid":"border-none")+" border-2 text-center svelte-mesu7o")&&d(t,"class",o)},i:Se,o:Se,d(c){c&&I(t),a=!1,ze(s)}}}function rl(e,t,l){let{checked:i=!1}=t,{text:o="O"}=t,{bgcolor:a=""}=t,{toggleClass:s=a?"":"bg-green-600"}=t,c=()=>{console.log("toggle"),l(0,i=!i)};function n(r){Wt.call(this,e,r)}return e.$$set=r=>{"checked"in r&&l(0,i=r.checked),"text"in r&&l(1,o=r.text),"bgcolor"in r&&l(2,a=r.bgcolor),"toggleClass"in r&&l(3,s=r.toggleClass)},[i,o,a,s,c,n]}class ve extends _t{constructor(t){super(),ht(this,t,rl,ol,gt,{checked:0,text:1,bgcolor:2,toggleClass:3})}}function kt(e,t,l){const i=e.slice();return i[5]=t[l],i}function wt(e){let t,l;return{c(){t=v("span"),l=M("\xA0"),be(t,"background-color",e[5])},m(i,o){E(i,t,o),g(t,l)},p:Se,d(i){i&&I(t)}}}function sl(e){let t,l,i,o,a,s,c=e[3],n=[];for(let r=0;r<c.length;r+=1)n[r]=wt(kt(e,c,r));return{c(){t=v("button"),l=M(e[2]),i=P(),o=v("div");for(let r=0;r<n.length;r+=1)n[r].c();d(o,"class","svelte-63dooi"),d(t,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),U(t,"bg-green-600",e[1]==e[0])},m(r,b){E(r,t,b),g(t,l),g(t,i),g(t,o);for(let k=0;k<n.length;k+=1)n[k].m(o,null);a||(s=T(t,"click",e[4]),a=!0)},p(r,[b]){if(b&4&&ue(l,r[2]),b&8){c=r[3];let k;for(k=0;k<c.length;k+=1){const h=kt(r,c,k);n[k]?n[k].p(h,b):(n[k]=wt(h),n[k].c(),n[k].m(o,null))}for(;k<n.length;k+=1)n[k].d(1);n.length=c.length}b&3&&U(t,"bg-green-600",r[1]==r[0])},i:Se,o:Se,d(r){r&&I(t),Ue(n,r),a=!1,s()}}}function al(e,t,l){let{color:i=""}=t,{selected:o=""}=t,{name:a="default"}=t,s=i.split(",");function c(n){Wt.call(this,e,n)}return e.$$set=n=>{"color"in n&&l(0,i=n.color),"selected"in n&&l(1,o=n.selected),"name"in n&&l(2,a=n.name)},[i,o,a,s,c]}class fl extends _t{constructor(t){super(),ht(this,t,al,sl,gt,{color:0,selected:1,name:2})}}const ut=(e,t)=>({r:e.r-t.r,g:e.g-t.g,b:e.b-t.b}),cl=(e,t)=>({r:e.r+t.r,g:e.g+t.g,b:e.b+t.b}),ul=(e,t,l)=>Math.max(e,Math.min(t,l));let st={};const Vt=e=>{if(st[e])return st[e];{if(e.length==4){let[a,s,c,n]=e.split("");e="#"+s+s+c+c+n+n}let t=parseInt(e.substring(1,3),16),l=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16),o={r:t,g:l,b:i};return st[e]=o,o}},pt=(e,t,l)=>{let i=ut(l?Xt(e):e,t),o=Math.abs(i.r),a=Math.abs(i.g),s=Math.abs(i.b);return o*o+s*s+a*a};let at={};const gl=(e,t,l)=>{let i;at[t]?i=at[t]:(i=t.split(","),at[t]=i);let o=i[0],a=null;return i.forEach((s,c)=>{let n=Vt(s),r=pt(n,e,l);(a==null||a>r)&&(a=r,o=n)}),o},dl=(e,t,l)=>{let i=t[0],o=null;return t.forEach((a,s)=>{let c=pt(a,e,l);(o==null||o>c)&&(o=c,i=a)}),i},Qt=e=>Math.floor((e.r+e.g+e.b)/3),hl=e=>"#"+e.r.toString(16).padStart(2,"0")+e.g.toString(16).padStart(2,"0")+e.b.toString(16).padStart(2,"0"),Xt=e=>{let t=Qt(e);return{r:t,g:t,b:t}};function _l(e){let t=0;for(let l=0,i=e.length;l<i;l++){let o=e.charCodeAt(l);t=(t<<5)-t+o,t|=0}return t}const mt=(e,t,l)=>(t*l+e)*4;let pl=function(e,t,l,i){let o=e.width,a=mt(t,l,o);e.data[a]=i.r,e.data[a+1]=i.g,e.data[a+2]=i.b},ml=function(e,t,l){e.data[t]=l},bl=function(e,t,l){let i=e.width,o=mt(t,l,i);return{r:e.data[o],g:e.data[o+1],b:e.data[o+2]}};const R={getPixelDataRGB:bl,setPixelDataRGB:pl,setPixelDataRaw:ml,calc_i:mt,hashCode:_l,Rgb2Gray:Xt,RgbGrayValue:Qt,RgbToHex:hl,nearestPixel:gl,nearestPixel2:dl,clamp:ul,pixelAdd:cl,pixelDiff:ut,hexToRgb:Vt,calculatePixelDifference:pt};function vt(e,t,l){const i=e.slice();return i[59]=t[l],i}function zt(e,t,l){const i=e.slice();return i[62]=t[l],i[63]=t,i[64]=l,i}function yt(e,t,l){const i=e.slice();return i[65]=t[l],i[66]=t,i[67]=l,i}function Dt(e,t,l){const i=e.slice();return i[68]=t[l],i}function Pt(e,t,l){const i=e.slice();return i[71]=t[l],i}function Rt(e){let t,l,i,o,a,s,c,n,r,b=e[0].width+"",k,h,p,u,z,O,w,D,le,G,V,ne;function te(m){e[28](m)}let H={text:"Pixelated"};e[0].pixelated!==void 0&&(H.checked=e[0].pixelated),z=new ve({props:H}),he.push(()=>Ce(z,"checked",te));function W(m){e[29](m)}let S={text:"Cache"};return e[0].cache!==void 0&&(S.checked=e[0].cache),D=new ve({props:S}),he.push(()=>Ce(D,"checked",W)),{c(){t=v("div"),l=v("div"),i=v("div"),o=v("span"),o.textContent="Width",a=P(),s=v("input"),n=P(),r=v("span"),k=M(b),h=P(),p=v("div"),u=v("div"),ke(z.$$.fragment),w=P(),ke(D.$$.fragment),d(o,"class","svelte-1g1m22k"),be(s,"flex","1"),d(s,"type","range"),d(s,"min","3"),d(s,"max",c=e[0].max_width),d(s,"step","3"),d(s,"class","svelte-1g1m22k"),d(r,"class","svelte-1g1m22k"),d(i,"class","flex slider-wrapper svelte-1g1m22k"),d(u,"class","d-block"),d(p,"class","flex"),d(l,"class","flex flex-col"),d(t,"class","bg-white text-black p-2")},m(m,C){E(m,t,C),g(t,l),g(l,i),g(i,o),g(i,a),g(i,s),ge(s,e[0].width),g(i,n),g(i,r),g(r,k),g(l,h),g(l,p),g(p,u),pe(z,u,null),g(u,w),pe(D,u,null),G=!0,V||(ne=[T(s,"change",e[27]),T(s,"input",e[27])],V=!0)},p(m,C){(!G||C[0]&1&&c!==(c=m[0].max_width))&&d(s,"max",c),C[0]&1&&ge(s,m[0].width),(!G||C[0]&1)&&b!==(b=m[0].width+"")&&ue(k,b);const N={};!O&&C[0]&1&&(O=!0,N.checked=m[0].pixelated,Ie(()=>O=!1)),z.$set(N);const K={};!le&&C[0]&1&&(le=!0,K.checked=m[0].cache,Ie(()=>le=!1)),D.$set(K)},i(m){G||(B(z.$$.fragment,m),B(D.$$.fragment,m),G=!0)},o(m){q(z.$$.fragment,m),q(D.$$.fragment,m),G=!1},d(m){m&&I(t),me(z),me(D),V=!1,ze(ne)}}}function It(e){let t,l,i,o,a,s,c,n,r,b,k,h,p,u,z=e[0].rubiks_scale+"",O,w,D,le,G,V,ne,te=e[0].grid_size+"",H,W,S,m;function C(F){e[30](F)}let N={text:"rubiks"};e[0].show_rubiks!==void 0&&(N.checked=e[0].show_rubiks),o=new ve({props:N}),he.push(()=>Ce(o,"checked",C));function K(F){e[31](F)}let we={text:"Show Grid"};return e[0].show_grid!==void 0&&(we.checked=e[0].show_grid),c=new ve({props:we}),he.push(()=>Ce(c,"checked",K)),{c(){t=v("div"),l=v("div"),i=v("div"),ke(o.$$.fragment),s=P(),ke(c.$$.fragment),r=P(),b=v("div"),k=M(`Scale\r
            `),h=v("input"),p=P(),u=v("span"),O=M(z),w=P(),D=v("span"),D.textContent="\xA0",le=M(`\r
            Grid Size\r
            `),G=v("input"),V=P(),ne=v("span"),H=M(te),d(i,"class","flex"),d(h,"type","range"),d(h,"max","40"),be(D,"margin-left","10px"),d(G,"type","range"),d(G,"max","10"),d(b,"class","flex"),d(l,"class","flex flex-col"),d(t,"class","bg-white text-black p-2")},m(F,ae){E(F,t,ae),g(t,l),g(l,i),pe(o,i,null),g(i,s),pe(c,i,null),g(l,r),g(l,b),g(b,k),g(b,h),ge(h,e[0].rubiks_scale),g(b,p),g(b,u),g(u,O),g(b,w),g(b,D),g(b,le),g(b,G),ge(G,e[0].grid_size),g(b,V),g(b,ne),g(ne,H),W=!0,S||(m=[T(h,"change",e[32]),T(h,"input",e[32]),T(G,"change",e[33]),T(G,"input",e[33])],S=!0)},p(F,ae){const X={};!a&&ae[0]&1&&(a=!0,X.checked=F[0].show_rubiks,Ie(()=>a=!1)),o.$set(X);const Pe={};!n&&ae[0]&1&&(n=!0,Pe.checked=F[0].show_grid,Ie(()=>n=!1)),c.$set(Pe),ae[0]&1&&ge(h,F[0].rubiks_scale),(!W||ae[0]&1)&&z!==(z=F[0].rubiks_scale+"")&&ue(O,z),ae[0]&1&&ge(G,F[0].grid_size),(!W||ae[0]&1)&&te!==(te=F[0].grid_size+"")&&ue(H,te)},i(F){W||(B(o.$$.fragment,F),B(c.$$.fragment,F),W=!0)},o(F){q(o.$$.fragment,F),q(c.$$.fragment,F),W=!1},d(F){F&&I(t),me(o),me(c),S=!1,ze(m)}}}function Ct(e){let t,l,i,o,a,s,c=e[0].mockup_pixel_size+"",n,r,b,k,h,p,u,z=e[0].mockup_x+"",O,w,D,le,G,V=e[0].mockup_y+"",ne,te,H;function W(C,N){return C[1].mockup_hovering?kl:wl}let S=W(e),m=S(e);return{c(){t=v("div"),l=v("div"),m.c(),i=M(`\r
\r
        Mock Up Pixel\r
        `),o=v("input"),a=P(),s=v("span"),n=M(c),r=P(),b=v("br"),k=M(`\r
        Mock Up Position\r
        `),h=v("input"),p=P(),u=v("span"),O=M(z),w=P(),D=v("input"),le=P(),G=v("span"),ne=M(V),be(l,"height","100px"),d(l,"ondragover","return false"),d(l,"id","mockup_drop_zone"),d(l,"class","bg-red-500 h-full p-4"),d(o,"type","range"),d(o,"min","1"),d(o,"max","25"),d(h,"type","range"),d(h,"min","-500"),d(h,"max","500"),d(D,"type","range"),d(D,"min","-500"),d(D,"max","500"),d(t,"class","bg-white text-black p-2")},m(C,N){E(C,t,N),g(t,l),m.m(l,null),g(t,i),g(t,o),ge(o,e[0].mockup_pixel_size),g(t,a),g(t,s),g(s,n),g(t,r),g(t,b),g(t,k),g(t,h),ge(h,e[0].mockup_x),g(t,p),g(t,u),g(u,O),g(t,w),g(t,D),ge(D,e[0].mockup_y),g(t,le),g(t,G),g(G,ne),te||(H=[T(l,"drop",e[15]),T(l,"dragenter",e[16]),T(l,"dragleave",e[17]),T(o,"change",e[34]),T(o,"input",e[34]),T(h,"change",e[35]),T(h,"input",e[35]),T(D,"change",e[36]),T(D,"input",e[36])],te=!0)},p(C,N){S!==(S=W(C))&&(m.d(1),m=S(C),m&&(m.c(),m.m(l,null))),N[0]&1&&ge(o,C[0].mockup_pixel_size),N[0]&1&&c!==(c=C[0].mockup_pixel_size+"")&&ue(n,c),N[0]&1&&ge(h,C[0].mockup_x),N[0]&1&&z!==(z=C[0].mockup_x+"")&&ue(O,z),N[0]&1&&ge(D,C[0].mockup_y),N[0]&1&&V!==(V=C[0].mockup_y+"")&&ue(ne,V)},d(C){C&&I(t),m.d(),te=!1,ze(H)}}}function kl(e){let t;return{c(){t=M("Release to load file")},m(l,i){E(l,t,i)},d(l){l&&I(t)}}}function wl(e){let t;return{c(){t=M("Drop Mock Up Image here")},m(l,i){E(l,t,i)},d(l){l&&I(t)}}}function Et(e){let t,l,i,o,a,s,c,n,r,b,k,h,p,u,z,O,w,D,le,G,V;function ne(m){e[37](m)}let te={text:"Gray"};e[0].gray_scale_input!==void 0&&(te.checked=e[0].gray_scale_input),a=new ve({props:te}),he.push(()=>Ce(a,"checked",ne));function H(m){e[38](m)}let W={text:"Nearest Gray Pixel"};e[0].gray_scale_nearest_pixel!==void 0&&(W.checked=e[0].gray_scale_nearest_pixel),k=new ve({props:W}),he.push(()=>Ce(k,"checked",H)),z=new ve({props:{text:"No Dithering",checked:e[0].dithering==""}}),z.$on("click",e[39]),w=new ve({props:{text:"Patterned Dithering",checked:e[0].dithering=="pattern"}}),w.$on("click",e[40]);let S=e[0].dithering=="pattern"&&Bt(e);return G=new ve({props:{text:"Floyd Steinberg",checked:e[0].dithering=="fs"}}),G.$on("click",e[42]),{c(){t=v("div"),l=v("div"),i=v("span"),i.textContent="Input Image:",o=P(),ke(a.$$.fragment),c=P(),n=v("div"),r=v("span"),r.textContent="Nearest Pixel:",b=P(),ke(k.$$.fragment),p=P(),u=v("div"),ke(z.$$.fragment),O=P(),ke(w.$$.fragment),D=P(),S&&S.c(),le=P(),ke(G.$$.fragment),d(i,"class","p-2"),d(l,"class","flex"),d(r,"class","p-2"),d(n,"class","flex"),d(u,"class","flex"),d(t,"class","bg-white text-black p-2")},m(m,C){E(m,t,C),g(t,l),g(l,i),g(l,o),pe(a,l,null),g(t,c),g(t,n),g(n,r),g(n,b),pe(k,n,null),g(t,p),g(t,u),pe(z,u,null),g(u,O),pe(w,u,null),g(u,D),S&&S.m(u,null),g(u,le),pe(G,u,null),V=!0},p(m,C){const N={};!s&&C[0]&1&&(s=!0,N.checked=m[0].gray_scale_input,Ie(()=>s=!1)),a.$set(N);const K={};!h&&C[0]&1&&(h=!0,K.checked=m[0].gray_scale_nearest_pixel,Ie(()=>h=!1)),k.$set(K);const we={};C[0]&1&&(we.checked=m[0].dithering==""),z.$set(we);const F={};C[0]&1&&(F.checked=m[0].dithering=="pattern"),w.$set(F),m[0].dithering=="pattern"?S?S.p(m,C):(S=Bt(m),S.c(),S.m(u,le)):S&&(S.d(1),S=null);const ae={};C[0]&1&&(ae.checked=m[0].dithering=="fs"),G.$set(ae)},i(m){V||(B(a.$$.fragment,m),B(k.$$.fragment,m),B(z.$$.fragment,m),B(w.$$.fragment,m),B(G.$$.fragment,m),V=!0)},o(m){q(a.$$.fragment,m),q(k.$$.fragment,m),q(z.$$.fragment,m),q(w.$$.fragment,m),q(G.$$.fragment,m),V=!1},d(m){m&&I(t),me(a),me(k),me(z),me(w),S&&S.d(),me(G)}}}function Bt(e){let t,l,i,o=e[11],a=[];for(let s=0;s<o.length;s+=1)a[s]=Gt(Pt(e,o,s));return{c(){t=v("span"),t.textContent="Matrix:",l=P();for(let s=0;s<a.length;s+=1)a[s].c();i=dt(),d(t,"class","h-10 p-2")},m(s,c){E(s,t,c),E(s,l,c);for(let n=0;n<a.length;n+=1)a[n].m(s,c);E(s,i,c)},p(s,c){if(c[0]&2049){o=s[11];let n;for(n=0;n<o.length;n+=1){const r=Pt(s,o,n);a[n]?a[n].p(r,c):(a[n]=Gt(r),a[n].c(),a[n].m(i.parentNode,i))}for(;n<a.length;n+=1)a[n].d(1);a.length=o.length}},d(s){s&&I(t),s&&I(l),Ue(a,s),s&&I(i)}}}function Gt(e){let t,l=e[71].length+"",i,o,a,s;function c(){return e[41](e[71])}return{c(){t=v("button"),i=M(l),o=P(),d(t,"class","h-10 p-2 rounded-lg border-solid border-2"),U(t,"bg-green-600",e[0].matrix==e[71])},m(n,r){E(n,t,r),g(t,i),g(t,o),a||(s=T(t,"click",c),a=!0)},p(n,r){e=n,r[0]&2049&&U(t,"bg-green-600",e[0].matrix==e[71])},d(n){n&&I(t),a=!1,s()}}}function Nt(e){let t,l,i,o,a,s=e[10],c=[];for(let h=0;h<s.length;h+=1)c[h]=St(Dt(e,s,h));const n=h=>q(c[h],1,1,()=>{c[h]=null});let r=e[0].individual_pallette_colors,b=[];for(let h=0;h<r.length;h+=1)b[h]=Tt(yt(e,r,h));const k=h=>q(b[h],1,1,()=>{b[h]=null});return{c(){t=v("div"),l=v("div");for(let h=0;h<c.length;h+=1)c[h].c();i=P(),o=v("div");for(let h=0;h<b.length;h+=1)b[h].c();d(l,"class","flex"),d(t,"class","bg-white text-black p-2"),d(o,"class","flex")},m(h,p){E(h,t,p),g(t,l);for(let u=0;u<c.length;u+=1)c[u].m(l,null);E(h,i,p),E(h,o,p);for(let u=0;u<b.length;u+=1)b[u].m(o,null);a=!0},p(h,p){if(p[0]&263169){s=h[10];let u;for(u=0;u<s.length;u+=1){const z=Dt(h,s,u);c[u]?(c[u].p(z,p),B(c[u],1)):(c[u]=St(z),c[u].c(),B(c[u],1),c[u].m(l,null))}for(Be(),u=s.length;u<c.length;u+=1)n(u);Ge()}if(p[0]&1){r=h[0].individual_pallette_colors;let u;for(u=0;u<r.length;u+=1){const z=yt(h,r,u);b[u]?(b[u].p(z,p),B(b[u],1)):(b[u]=Tt(z),b[u].c(),B(b[u],1),b[u].m(o,null))}for(Be(),u=r.length;u<b.length;u+=1)k(u);Ge()}},i(h){if(!a){for(let p=0;p<s.length;p+=1)B(c[p]);for(let p=0;p<r.length;p+=1)B(b[p]);a=!0}},o(h){c=c.filter(Boolean);for(let p=0;p<c.length;p+=1)q(c[p]);b=b.filter(Boolean);for(let p=0;p<b.length;p+=1)q(b[p]);a=!1},d(h){h&&I(t),Ue(c,h),h&&I(i),h&&I(o),Ue(b,h)}}}function St(e){let t,l;function i(...o){return e[43](e[68],...o)}return t=new fl({props:{selected:e[0].pallette,name:e[68].name,color:e[68].colors}}),t.$on("click",i),{c(){ke(t.$$.fragment)},m(o,a){pe(t,o,a),l=!0},p(o,a){e=o;const s={};a[0]&1&&(s.selected=e[0].pallette),t.$set(s)},i(o){l||(B(t.$$.fragment,o),l=!0)},o(o){q(t.$$.fragment,o),l=!1},d(o){me(t,o)}}}function Tt(e){let t,l,i;function o(s){e[44](s,e[65])}let a={text:e[65].color,bgcolor:e[65].on?e[65].color:"white"};return e[65].on!==void 0&&(a.checked=e[65].on),t=new ve({props:a}),he.push(()=>Ce(t,"checked",o)),{c(){ke(t.$$.fragment)},m(s,c){pe(t,s,c),i=!0},p(s,c){e=s;const n={};c[0]&1&&(n.text=e[65].color),c[0]&1&&(n.bgcolor=e[65].on?e[65].color:"white"),!l&&c[0]&1&&(l=!0,n.checked=e[65].on,Ie(()=>l=!1)),t.$set(n)},i(s){i||(B(t.$$.fragment,s),i=!0)},o(s){q(t.$$.fragment,s),i=!1},d(s){me(t,s)}}}function Mt(e){let t,l,i,o,a,s,c,n,r,b,k,h=e[0].dithering=="pattern"&&Ot(e),p=e[0].dithering=="fs"&&Lt(e);return{c(){t=v("code"),l=M(e[9]),i=P(),o=v("input"),s=P(),h&&h.c(),c=P(),p&&p.c(),n=dt(),d(o,"type","range"),d(o,"min","-1"),d(o,"max",a=e[1].total_pixels),d(o,"step","1")},m(u,z){E(u,t,z),g(t,l),E(u,i,z),E(u,o,z),ge(o,e[0].debug_range),E(u,s,z),h&&h.m(u,z),E(u,c,z),p&&p.m(u,z),E(u,n,z),r=!0,b||(k=[T(o,"change",e[45]),T(o,"input",e[45])],b=!0)},p(u,z){(!r||z[0]&512)&&ue(l,u[9]),(!r||z[0]&2&&a!==(a=u[1].total_pixels))&&d(o,"max",a),z[0]&1&&ge(o,u[0].debug_range),u[0].dithering=="pattern"?h?h.p(u,z):(h=Ot(u),h.c(),h.m(c.parentNode,c)):h&&(h.d(1),h=null),u[0].dithering=="fs"?p?(p.p(u,z),z[0]&1&&B(p,1)):(p=Lt(u),p.c(),B(p,1),p.m(n.parentNode,n)):p&&(Be(),q(p,1,1,()=>{p=null}),Ge())},i(u){r||(B(p),r=!0)},o(u){q(p),r=!1},d(u){u&&I(t),u&&I(i),u&&I(o),u&&I(s),h&&h.d(u),u&&I(c),p&&p.d(u),u&&I(n),b=!1,ze(k)}}}function Ot(e){let t,l=e[0].matrix,i=[];for(let o=0;o<l.length;o+=1)i[o]=At(vt(e,l,o));return{c(){for(let o=0;o<i.length;o+=1)i[o].c();t=dt()},m(o,a){for(let s=0;s<i.length;s+=1)i[s].m(o,a);E(o,t,a)},p(o,a){if(a[0]&1){l=o[0].matrix;let s;for(s=0;s<l.length;s+=1){const c=vt(o,l,s);i[s]?i[s].p(c,a):(i[s]=At(c),i[s].c(),i[s].m(t.parentNode,t))}for(;s<i.length;s+=1)i[s].d(1);i.length=l.length}},d(o){Ue(i,o),o&&I(t)}}}function Ft(e){let t,l,i=e[62]+"",o,a,s;function c(){e[46].call(t,e[63],e[64])}return{c(){t=v("input"),l=P(),o=M(i),d(t,"type","range"),d(t,"step","0.01"),d(t,"max","1.0"),d(t,"min","0.0")},m(n,r){E(n,t,r),ge(t,e[62]),E(n,l,r),E(n,o,r),a||(s=[T(t,"change",c),T(t,"input",c)],a=!0)},p(n,r){e=n,r[0]&1&&ge(t,e[62]),r[0]&1&&i!==(i=e[62]+"")&&ue(o,i)},d(n){n&&I(t),n&&I(l),n&&I(o),a=!1,ze(s)}}}function At(e){let t,l,i=e[59],o=[];for(let a=0;a<i.length;a+=1)o[a]=Ft(zt(e,i,a));return{c(){t=v("div");for(let a=0;a<o.length;a+=1)o[a].c();l=P(),d(t,"class","flex")},m(a,s){E(a,t,s);for(let c=0;c<o.length;c+=1)o[c].m(t,null);g(t,l)},p(a,s){if(s[0]&1){i=a[59];let c;for(c=0;c<i.length;c+=1){const n=zt(a,i,c);o[c]?o[c].p(n,s):(o[c]=Ft(n),o[c].c(),o[c].m(t,l))}for(;c<o.length;c+=1)o[c].d(1);o.length=i.length}},d(a){a&&I(t),Ue(o,a)}}}function Lt(e){let t,l,i;function o(s){e[47](s)}let a={text:"Cap"};return e[0].cap!==void 0&&(a.checked=e[0].cap),t=new ve({props:a}),he.push(()=>Ce(t,"checked",o)),{c(){ke(t.$$.fragment)},m(s,c){pe(t,s,c),i=!0},p(s,c){const n={};!l&&c[0]&1&&(l=!0,n.checked=s[0].cap,Ie(()=>l=!1)),t.$set(n)},i(s){i||(B(t.$$.fragment,s),i=!0)},o(s){q(t.$$.fragment,s),i=!1},d(s){me(t,s)}}}function Ut(e){let t;return{c(){t=v("div"),t.textContent="Drop to load image",d(t,"class","rounded-lg border-solid border-2 p-8 text-white text-center m-auto w-fit")},m(l,i){E(l,t,i)},d(l){l&&I(t)}}}function qt(e){let t,l=e[1].resizedwidth+"",i,o,a=e[1].resizedheight+"",s,c,n=e[1].resizedwidth*e[1].resizedheight+"",r,b,k=e[1].resizedheight*e[1].resizedwidth/9+"",h,p,u,z,O;return{c(){t=M("Image Size: "),i=M(l),o=M(" x "),s=M(a),c=M(" = "),r=M(n),b=M(`\r
      | Total Rubiks: `),h=M(k),p=M(`\r
\r
      WIDTH: `),u=M(e[2]),z=M(`\r
      HEIGHT: `),O=M(e[4])},m(w,D){E(w,t,D),E(w,i,D),E(w,o,D),E(w,s,D),E(w,c,D),E(w,r,D),E(w,b,D),E(w,h,D),E(w,p,D),E(w,u,D),E(w,z,D),E(w,O,D)},p(w,D){D[0]&2&&l!==(l=w[1].resizedwidth+"")&&ue(i,l),D[0]&2&&a!==(a=w[1].resizedheight+"")&&ue(s,a),D[0]&2&&n!==(n=w[1].resizedwidth*w[1].resizedheight+"")&&ue(r,n),D[0]&2&&k!==(k=w[1].resizedheight*w[1].resizedwidth/9+"")&&ue(h,k),D[0]&4&&ue(u,w[2]),D[0]&16&&ue(O,w[4])},d(w){w&&I(t),w&&I(i),w&&I(o),w&&I(s),w&&I(c),w&&I(r),w&&I(b),w&&I(h),w&&I(p),w&&I(u),w&&I(z),w&&I(O)}}}function vl(e){let t,l,i,o,a,s,c,n,r,b,k,h,p,u,z,O,w,D,le,G,V,ne,te,H,W,S,m,C,N,K,we,F,ae,X,Pe,Te,Je,Re,ie,Me,Oe,Ke,Ve,Q,Fe,Ae,Qe,Xe,A,qe,Ye;function ot(f){e[26](f)}let Ze={text:"debug"};e[1].show_debug!==void 0&&(Ze.checked=e[1].show_debug),w=new ve({props:Ze}),he.push(()=>Ce(w,"checked",ot));let Y=e[1].current=="img"&&Rt(e),Z=e[1].current=="rubiks"&&It(e),fe=e[1].current=="mockup"&&Ct(e),$=e[1].current=="processing"&&Et(e),x=e[1].current=="pallette"&&Nt(e),ee=e[1].show_debug&&Mt(e),de=!e[3]&&e[1].hovering&&Ut(),ce=e[1].resizedheight&&e[1].resizedwidth&&qt(e);return{c(){t=v("main"),l=v("div"),i=v("div"),o=v("div"),a=v("button"),a.textContent="Output Image",s=P(),c=v("button"),c.textContent="Pallette",n=P(),r=v("button"),r.textContent="Processing",b=P(),k=v("button"),k.textContent="Rubiks",h=P(),p=v("button"),p.textContent="Mock Up",u=P(),z=v("div"),O=P(),ke(w.$$.fragment),le=P(),Y&&Y.c(),G=P(),Z&&Z.c(),V=P(),fe&&fe.c(),ne=P(),$&&$.c(),te=P(),x&&x.c(),H=P(),ee&&ee.c(),W=P(),S=v("div"),m=v("div"),C=v("div"),N=v("div"),K=v("canvas"),ae=P(),X=v("canvas"),Je=P(),Re=v("div"),ie=v("canvas"),Ve=P(),Q=v("canvas"),Qe=P(),de&&de.c(),Xe=P(),ce&&ce.c(),d(a,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),U(a,"bg-gray-400",e[1].current=="img"),d(c,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),U(c,"bg-gray-400",e[1].current=="pallette"),d(r,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),U(r,"bg-gray-400",e[1].current=="processing"),d(k,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),U(k,"bg-gray-400",e[1].current=="rubiks"),d(p,"class","h-10 p-2 rounded-lg border-solid border-2 text-center"),U(p,"bg-gray-400",e[1].current=="mockup"),d(z,"class","spacer svelte-1g1m22k"),d(o,"class","flex"),d(i,"class","bg-white text-black p-2"),d(K,"class","small svelte-1g1m22k"),d(K,"id","canvas"),d(K,"width",we=e[1].canvaswidth),d(K,"height",F=e[1].canvasheight),U(K,"shown",e[3]),U(K,"pixelated",e[0].pixelated),d(X,"id","output_canvas"),d(X,"width",Pe=e[1].resizedwidth),d(X,"height",Te=e[1].resizedheight),d(X,"class","svelte-1g1m22k"),U(X,"small",e[0].show_rubiks),U(X,"shown",e[3]),U(X,"pixelated",e[0].pixelated),be(ie,"position","absolute"),d(ie,"id","bgcanvas"),d(ie,"width",Me=e[1].mockupwidth),d(ie,"height",Oe=e[1].mockupheight),d(ie,"class","svelte-1g1m22k"),it(()=>e[51].call(ie)),U(ie,"shown",e[0].has_mockup),be(Q,"position","absolute"),be(Q,"top",e[4]/2-e[1].resizedheight*e[0].mockup_pixel_size*e[2]/e[1].mockupwidth/2+e[0].mockup_y*e[2]/e[1].mockupwidth+"px"),be(Q,"left",e[2]/2-e[1].resizedwidth*e[0].mockup_pixel_size*e[2]/e[1].mockupwidth/2+e[0].mockup_x*e[2]/e[1].mockupwidth+"px"),be(Q,"width",e[1].resizedwidth*e[0].mockup_pixel_size*e[2]/e[1].mockupwidth+"px"),d(Q,"id","rubiks_canvas"),d(Q,"width",Fe=e[1].resizedwidth*e[0].rubiks_scale),d(Q,"height",Ae=e[1].resizedheight*e[0].rubiks_scale),d(Q,"class","svelte-1g1m22k"),U(Q,"shown",e[3]&&e[0].show_rubiks),U(Q,"pixelated",e[0].pixelated),be(Re,"position","relative"),d(Re,"id","canvas_wrapper"),d(N,"class","flex-col"),d(C,"class","flex"),d(m,"ondragover","return false"),d(m,"id","drop_zone"),d(m,"class","bg-white h-full"),d(S,"class","bg-green-800 grow justify-center"),d(l,"class","flex flex-col bg-red-800 h-screen")},m(f,_){E(f,t,_),g(t,l),g(l,i),g(i,o),g(o,a),g(o,s),g(o,c),g(o,n),g(o,r),g(o,b),g(o,k),g(o,h),g(o,p),g(o,u),g(o,z),g(o,O),pe(w,o,null),g(l,le),Y&&Y.m(l,null),g(l,G),Z&&Z.m(l,null),g(l,V),fe&&fe.m(l,null),g(l,ne),$&&$.m(l,null),g(l,te),x&&x.m(l,null),g(l,H),ee&&ee.m(l,null),g(l,W),g(l,S),g(S,m),g(m,C),g(C,N),g(N,K),e[48](K),g(N,ae),g(N,X),e[49](X),g(N,Je),g(N,Re),g(Re,ie),e[50](ie),Ke=el(ie,e[51].bind(ie)),g(Re,Ve),g(Re,Q),e[52](Q),g(m,Qe),de&&de.m(m,null),g(l,Xe),ce&&ce.m(l,null),A=!0,qe||(Ye=[T(a,"click",e[21]),T(c,"click",e[22]),T(r,"click",e[23]),T(k,"click",e[24]),T(p,"click",e[25]),T(m,"drop",e[12]),T(m,"dragenter",e[13]),T(m,"dragleave",e[14])],qe=!0)},p(f,_){(!A||_[0]&2)&&U(a,"bg-gray-400",f[1].current=="img"),(!A||_[0]&2)&&U(c,"bg-gray-400",f[1].current=="pallette"),(!A||_[0]&2)&&U(r,"bg-gray-400",f[1].current=="processing"),(!A||_[0]&2)&&U(k,"bg-gray-400",f[1].current=="rubiks"),(!A||_[0]&2)&&U(p,"bg-gray-400",f[1].current=="mockup");const y={};!D&&_[0]&2&&(D=!0,y.checked=f[1].show_debug,Ie(()=>D=!1)),w.$set(y),f[1].current=="img"?Y?(Y.p(f,_),_[0]&2&&B(Y,1)):(Y=Rt(f),Y.c(),B(Y,1),Y.m(l,G)):Y&&(Be(),q(Y,1,1,()=>{Y=null}),Ge()),f[1].current=="rubiks"?Z?(Z.p(f,_),_[0]&2&&B(Z,1)):(Z=It(f),Z.c(),B(Z,1),Z.m(l,V)):Z&&(Be(),q(Z,1,1,()=>{Z=null}),Ge()),f[1].current=="mockup"?fe?fe.p(f,_):(fe=Ct(f),fe.c(),fe.m(l,ne)):fe&&(fe.d(1),fe=null),f[1].current=="processing"?$?($.p(f,_),_[0]&2&&B($,1)):($=Et(f),$.c(),B($,1),$.m(l,te)):$&&(Be(),q($,1,1,()=>{$=null}),Ge()),f[1].current=="pallette"?x?(x.p(f,_),_[0]&2&&B(x,1)):(x=Nt(f),x.c(),B(x,1),x.m(l,H)):x&&(Be(),q(x,1,1,()=>{x=null}),Ge()),f[1].show_debug?ee?(ee.p(f,_),_[0]&2&&B(ee,1)):(ee=Mt(f),ee.c(),B(ee,1),ee.m(l,W)):ee&&(Be(),q(ee,1,1,()=>{ee=null}),Ge()),(!A||_[0]&2&&we!==(we=f[1].canvaswidth))&&d(K,"width",we),(!A||_[0]&2&&F!==(F=f[1].canvasheight))&&d(K,"height",F),(!A||_[0]&8)&&U(K,"shown",f[3]),(!A||_[0]&1)&&U(K,"pixelated",f[0].pixelated),(!A||_[0]&2&&Pe!==(Pe=f[1].resizedwidth))&&d(X,"width",Pe),(!A||_[0]&2&&Te!==(Te=f[1].resizedheight))&&d(X,"height",Te),(!A||_[0]&1)&&U(X,"small",f[0].show_rubiks),(!A||_[0]&8)&&U(X,"shown",f[3]),(!A||_[0]&1)&&U(X,"pixelated",f[0].pixelated),(!A||_[0]&2&&Me!==(Me=f[1].mockupwidth))&&d(ie,"width",Me),(!A||_[0]&2&&Oe!==(Oe=f[1].mockupheight))&&d(ie,"height",Oe),(!A||_[0]&1)&&U(ie,"shown",f[0].has_mockup),(!A||_[0]&23)&&be(Q,"top",f[4]/2-f[1].resizedheight*f[0].mockup_pixel_size*f[2]/f[1].mockupwidth/2+f[0].mockup_y*f[2]/f[1].mockupwidth+"px"),(!A||_[0]&7)&&be(Q,"left",f[2]/2-f[1].resizedwidth*f[0].mockup_pixel_size*f[2]/f[1].mockupwidth/2+f[0].mockup_x*f[2]/f[1].mockupwidth+"px"),(!A||_[0]&7)&&be(Q,"width",f[1].resizedwidth*f[0].mockup_pixel_size*f[2]/f[1].mockupwidth+"px"),(!A||_[0]&3&&Fe!==(Fe=f[1].resizedwidth*f[0].rubiks_scale))&&d(Q,"width",Fe),(!A||_[0]&3&&Ae!==(Ae=f[1].resizedheight*f[0].rubiks_scale))&&d(Q,"height",Ae),(!A||_[0]&9)&&U(Q,"shown",f[3]&&f[0].show_rubiks),(!A||_[0]&1)&&U(Q,"pixelated",f[0].pixelated),!f[3]&&f[1].hovering?de||(de=Ut(),de.c(),de.m(m,null)):de&&(de.d(1),de=null),f[1].resizedheight&&f[1].resizedwidth?ce?ce.p(f,_):(ce=qt(f),ce.c(),ce.m(l,null)):ce&&(ce.d(1),ce=null)},i(f){A||(B(w.$$.fragment,f),B(Y),B(Z),B($),B(x),B(ee),A=!0)},o(f){q(w.$$.fragment,f),q(Y),q(Z),q($),q(x),q(ee),A=!1},d(f){f&&I(t),me(w),Y&&Y.d(),Z&&Z.d(),fe&&fe.d(),$&&$.d(),x&&x.d(),ee&&ee.d(),e[48](null),e[49](null),e[50](null),Ke(),e[52](null),de&&de.d(),ce&&ce.d(),qe=!1,ze(Ye)}}}function zl(e,t,l){let i,o,a=!1,s=[{name:"rbk",colors:"#013082,#BB2328,#01B351,#FE8F25,#F5FF42,#ECF3F6"},{name:"rbkng",colors:"#013082,#BB2328,#FE8F25,#F5FF42,#ECF3F6"},{name:"b&w",colors:"#000,#fff"},{name:"gray",colors:"#000,#666,#fff"},{name:"grayscale",colors:"#000,#111,#222,#333,#444,#555,#666,#777,#888,#999,#aaa,#bbb,#ccc,#ddd,#eee,#fff"},{name:"rgb",colors:"#000,#f00,#0f0,#00f,#fff"},{name:"cmyk",colors:"#000,#0ff,#f0f,#ff0,#fff"}],c=[[[0/4,2/4],[3/4,1/4]],[[0/16,8/16,2/16,10/16],[12/16,4/16,14/16,6/16],[3/16,11/16,1/16,9/16],[15/16,7/16,13/16,5/16]]],n={loadedfile:"",cache:!0,cap:!1,pixelated:!0,has_mockup:!1,mockup_pixel_size:1,mockup_x:0,mockup_y:0,width:0,height:0,dithering:"pattern",max_width:600,show_rubiks:!0,show_grid:!1,rubiks_scale:8,gray_scale_input:!1,gray_scale_nearest_pixel:!1,grid_size:2,pallette:s[0].colors,individual_pallette_colors:[],debug_range:-1,matrix:c[0]},r={current:"",hovering:!1,mockup_hovering:!1,mockupheight:100,mockupwidth:100,show_debug:!1,resizedwidth:0,resizedheight:0,total_pixels:0,canvaswidth:100,canvasheight:100},b,k,h,p,u,z,O="",w={},D=function(f){f.preventDefault();let _=f;if(_.dataTransfer.items)if(_.dataTransfer.items.length==1){let y=_.dataTransfer.items[0];if(y.kind==="file"){const _e=y.getAsFile();m(_e)}else console.log("kind is not file, but: "+y.kind)}else l(9,o="Error: can only load one file");l(1,r.hovering=!1,r)},le=function(){console.log("drag enter"),l(1,r.hovering=!0,r)},G=function(){l(1,r.hovering=!1,r)},V=function(f){f.preventDefault();let _=f;if(_.dataTransfer.items)if(_.dataTransfer.items.length==1){let y=_.dataTransfer.items[0];if(y.kind==="file"){const _e=y.getAsFile();l(0,n.has_mockup=!0,n),S(_e)}else console.log("kind is not file, but: "+y.kind)}else l(9,o="Error: can only load one file");l(1,r.mockup_hovering=!1,r)},ne=function(){console.log("drag enter"),l(1,r.mockup_hovering=!0,r)},te=function(){l(1,r.mockup_hovering=!1,r)},H,W,S=function(f){let _=p.getContext("2d");W=new Image,W.onload=async function(){await et(),l(1,r.mockupheight=W.height,r),l(1,r.mockupwidth=W.width,r),await et(),_.drawImage(W,0,0,W.width,W.height)},W.src=URL.createObjectURL(f)},m=function(f){l(0,n.loadedfile=f.name,n);let _=h.getContext("2d");H=new Image,H.onload=async function(){l(1,r.canvasheight=H.height,r),l(1,r.canvaswidth=H.width,r),l(0,n.width=Math.min(99,r.canvaswidth),n),l(0,n.max_width=Math.min(r.canvaswidth,999),n),l(3,a=!0),w={},await et(),_.drawImage(H,0,0,H.width,H.height)},H.src=URL.createObjectURL(f)},C=function(f){l(0,n.pallette=f,n),l(0,n.individual_pallette_colors=[],n),f.split(",").forEach(_=>{n.individual_pallette_colors.push({color:_,on:!0})})},N=function(f){r.current==f?l(1,r.current="",r):l(1,r.current=f,r)};ll(async()=>{if(!n.width){console.log("no width, ending here");return}if(!a){console.log("no image loaded, ending here");return}if(!H){console.log("originalImage is empty","ending here");return}let f=r.canvasheight/r.canvaswidth*n.width;if(l(0,n.height=f,n),l(1,r.resizedwidth=parseInt(n.width/3)*3,r),l(1,r.resizedheight=parseInt(f/3)*3,r),l(1,r.total_pixels=r.resizedheight*r.resizedwidth,r),await et(),f<1){console.log("height is less than 1","ending here");return}if(O=R.hashCode(JSON.stringify(i)),n.cache&&O&&w[O]){console.log("found",i.loadedfile,O,"from cache");let _=u.getContext("2d"),y=w[O].data,_e=new ImageData(y.data,y.width,y.height);_.putImageData(_e,0,0)}else{console.log("GENERATING IMAGE",JSON.stringify(i),O);let _=u.getContext("2d");_.drawImage(H,0,0,r.resizedwidth,r.resizedheight);let y=_.getImageData(0,0,r.resizedwidth,r.resizedheight);if(n.gray_scale_input)for(let L=0,oe=0;L<y.height;L++)for(let J=0;J<y.width;J++,oe+=4){let Le=R.getPixelDataRGB(y,J,L),De=Math.round((Le.r+Le.g+Le.b)/3);R.setPixelDataRaw(y,oe,De),R.setPixelDataRaw(y,oe+1,De),R.setPixelDataRaw(y,oe+2,De)}let _e=n.pallette;n.individual_pallette_colors.length&&(_e=n.individual_pallette_colors.filter(L=>L.on).map(L=>L.color).join(","));let ye=_e.split(",").length,$e=_e.split(",");$e.forEach((L,oe)=>{$e[oe]=R.hexToRgb(L)});for(let L=0,oe=0;L<y.height;L++)for(let J=0;J<y.width;J++,oe+=4){let Le=R.getPixelDataRGB(y,J,L),De=R.nearestPixel2(Le,$e,n.gray_scale_nearest_pixel);if(n.dithering=="")R.setPixelDataRaw(y,oe,De.r),R.setPixelDataRaw(y,oe+1,De.g),R.setPixelDataRaw(y,oe+2,De.b);else if(n.dithering=="fs"){R.setPixelDataRaw(y,oe,De.r),R.setPixelDataRaw(y,oe+1,De.g),R.setPixelDataRaw(y,oe+2,De.b);let j=R.pixelDiff(Le,De);if(J<y.width-1){let re=R.getPixelDataRGB(y,J+1,L);n.cap?R.setPixelDataRGB(y,J+1,L,{r:R.clamp(0,255,re.r+j.r*7/16),g:R.clamp(0,255,re.g+j.g*7/16),b:R.clamp(0,255,re.b+j.b*7/16)}):R.setPixelDataRGB(y,J+1,L,{r:re.r+j.r*7/16,g:re.g+j.g*7/16,b:re.b+j.b*7/16})}if(L<y.height-1){if(J>0){let se=R.getPixelDataRGB(y,J-1,L+1);n.cap?R.setPixelDataRGB(y,J-1,L+1,{r:R.clamp(0,255,se.r+j.r*3/16),g:R.clamp(0,255,se.g+j.g*3/16),b:R.clamp(0,255,se.b+j.b*3/16)}):R.setPixelDataRGB(y,J-1,L+1,{r:se.r+j.r*3/16,g:se.g+j.g*3/16,b:se.b+j.b*3/16})}let re=R.getPixelDataRGB(y,J,L+1);if(n.cap?R.setPixelDataRGB(y,J,L+1,{r:R.clamp(0,255,re.r+j.r*5/16),g:R.clamp(0,255,re.g+j.g*5/16),b:R.clamp(0,255,re.b+j.b*5/16)}):R.setPixelDataRGB(y,J,L+1,{r:re.r+j.r*5/16,g:re.g+j.g*5/16,b:re.b+j.b*5/16}),J<y.width-1){let se=R.getPixelDataRGB(y,J+1,L+1);n.cap?R.setPixelDataRGB(y,J+1,L+1,{r:R.clamp(0,255,se.r+j.r*1/16),g:R.clamp(0,255,se.g+j.g*1/16),b:R.clamp(0,255,se.b+j.b*1/16)}):R.setPixelDataRGB(y,J+1,L+1,{r:se.r+j.r*1/16,g:se.g+j.g*1/16,b:se.b+j.b*1/16})}}}else if(n.dithering=="pattern"){let j=R.getPixelDataRGB(y,J,L),re=255/ye*(n.matrix[J%n.matrix[0].length][L%n.matrix.length]-.5),se=R.nearestPixel2({r:j.r+re,g:j.g+re,b:j.b+re},$e,n.gray_scale_nearest_pixel);R.setPixelDataRaw(y,oe,se.r),R.setPixelDataRaw(y,oe+1,se.g),R.setPixelDataRaw(y,oe+2,se.b)}}if(_.putImageData(y,0,0),n.cache){let L=new ImageData(new Uint8ClampedArray(y.data),y.width,y.height);console.log("adding",O,"to cache"),w[O]={data:L,params:Object.assign({},i),config:Object.assign({},n)}}}if(n.show_rubiks){let _=z.getContext("2d"),_e=u.getContext("2d").getImageData(0,0,r.resizedwidth,r.resizedheight);if(_.imageSmoothingEnabled=!1,_.drawImage(u,0,0,r.resizedwidth*n.rubiks_scale,r.resizedheight*n.rubiks_scale),n.show_grid&&n.grid_size>0){_.lineWidth=n.grid_size,_.strokeStyle="#000000";for(let ye=0;ye<_e.height;ye++)_.beginPath(),_.moveTo(0,ye*n.rubiks_scale),_.lineTo(_e.width*n.rubiks_scale,ye*n.rubiks_scale),_.stroke();for(let ye=0;ye<_e.width;ye++)_.beginPath(),_.moveTo(ye*n.rubiks_scale,0),_.lineTo(ye*n.rubiks_scale,_e.height*n.rubiks_scale),_.stroke()}}});const K=()=>{N("img")},we=()=>{N("pallette")},F=()=>{N("processing")},ae=()=>{N("rubiks")},X=()=>{N("mockup")};function Pe(f){e.$$.not_equal(r.show_debug,f)&&(r.show_debug=f,l(1,r))}function Te(){n.width=Ee(this.value),l(0,n)}function Je(f){e.$$.not_equal(n.pixelated,f)&&(n.pixelated=f,l(0,n))}function Re(f){e.$$.not_equal(n.cache,f)&&(n.cache=f,l(0,n))}function ie(f){e.$$.not_equal(n.show_rubiks,f)&&(n.show_rubiks=f,l(0,n))}function Me(f){e.$$.not_equal(n.show_grid,f)&&(n.show_grid=f,l(0,n))}function Oe(){n.rubiks_scale=Ee(this.value),l(0,n)}function Ke(){n.grid_size=Ee(this.value),l(0,n)}function Ve(){n.mockup_pixel_size=Ee(this.value),l(0,n)}function Q(){n.mockup_x=Ee(this.value),l(0,n)}function Fe(){n.mockup_y=Ee(this.value),l(0,n)}function Ae(f){e.$$.not_equal(n.gray_scale_input,f)&&(n.gray_scale_input=f,l(0,n))}function Qe(f){e.$$.not_equal(n.gray_scale_nearest_pixel,f)&&(n.gray_scale_nearest_pixel=f,l(0,n))}const Xe=()=>l(0,n.dithering="",n),A=()=>l(0,n.dithering="pattern",n),qe=f=>{l(0,n.matrix=f,n)},Ye=()=>l(0,n.dithering="fs",n),ot=(f,_,y)=>{C(f.colors)};function Ze(f,_){e.$$.not_equal(_.on,f)&&(_.on=f,l(0,n))}function Y(){n.debug_range=Ee(this.value),l(0,n)}function Z(f,_){f[_]=Ee(this.value),l(0,n)}function fe(f){e.$$.not_equal(n.cap,f)&&(n.cap=f,l(0,n))}function $(f){he[f?"unshift":"push"](()=>{h=f,l(5,h)})}function x(f){he[f?"unshift":"push"](()=>{u=f,l(7,u)})}function ee(f){he[f?"unshift":"push"](()=>{p=f,l(6,p)})}function de(){k=this.clientHeight,b=this.clientWidth,l(4,k),l(2,b)}function ce(f){he[f?"unshift":"push"](()=>{z=f,l(8,z)})}return e.$$.update=()=>{e.$$.dirty[0]&1&&l(20,i={loadedfile:n.loadedfile,width:n.width,height:n.height,dithering:n.dithering,gray_scale_input:n.gray_scale_input,gray_scale_nearest_pixel:n.gray_scale_nearest_pixel,pallette:n.pallette,individual_pallette_colors:n.individual_pallette_colors,matrix:n.matrix}),e.$$.dirty[0]&1048583&&l(9,o=("UI = "+JSON.stringify(r)+`
params: `+JSON.stringify(i)+`
CONFIG:`+JSON.stringify(n)+"CLIENT WIDTH:"+b).replaceAll(",",", "))},[n,r,b,a,k,h,p,u,z,o,s,c,D,le,G,V,ne,te,C,N,i,K,we,F,ae,X,Pe,Te,Je,Re,ie,Me,Oe,Ke,Ve,Q,Fe,Ae,Qe,Xe,A,qe,Ye,ot,Ze,Y,Z,fe,$,x,ee,de,ce]}class yl extends _t{constructor(t){super(),ht(this,t,zl,vl,gt,{},null,[-1,-1,-1])}}new yl({target:document.getElementById("app")});
